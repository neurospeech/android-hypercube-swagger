function mapLibrary(n,t,i){var u=n.indexOf("."),r;return u==-1?(r=t[n],r||(r=i,t[n]=r),r):(r=mapLibrary(n.substr(0,u),t,{}),mapLibrary(n.substr(u+1),r,i))}function createProperty(n,t){return t?function(){return this[n]}:function(t){this[n]=t}}function classCreator(n,t,i,r,u){var o=t?t.constructor:null,s=i||function(){},h=u,e=null,c,f;if(o){e=u?function(){for(var t in h)this["_"+t]=h[t];o.apply(this,arguments);this.__typeName=n;s.apply(this,arguments)}:function(){o.apply(this,arguments);this.__typeName=n;s.apply(this,arguments)};c=o.prototype;for(f in c)r[f]||c.hasOwnProperty(f)&&(r[f]=c[f])}else e=u?function(){this.__typeName=n;for(var t in h)this["_"+t]=h[t];s.apply(this,arguments)}:function(){this.__typeName=n;s.apply(this,arguments)};if(u)for(f in u)r["get_"+f]||(r["get_"+f]=createProperty("_"+f,!0)),r["set_"+f]||(r["set_"+f]=createProperty("_"+f));return e.__typeName=n,o&&(e.__baseType=o),e.prototype=r,e.prototype.constructor=e,r.hasOwnProperty("toString")||(e.prototype.toString=function(){return n}),mapLibrary(/\./.test(n)?n:"WebAtoms."+n,window,e),e}function classCreatorEx(n){return classCreator(n.name,n.base,n.start,n.methods,n.properties)}window.createClass=classCreatorEx;window.classCreatorEx=classCreatorEx,function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(jQuery)}(function(n){var t=navigator.userAgent,u=/iphone/i.test(t),f=/chrome/i.test(t),i=/android/i.test(t),r;n.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"};n.fn.extend({caret:function(n,t){var i;if(this.length!==0&&!this.is(":hidden"))return typeof n=="number"?(t=typeof t=="number"?t:n,this.each(function(){this.setSelectionRange?this.setSelectionRange(n,t):this.createTextRange&&(i=this.createTextRange(),i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",n),i.select())})):(this[0].setSelectionRange?(n=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),n=0-i.duplicate().moveStart("character",-1e5),t=n+i.text.length),{begin:n,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(t,e){var y,l,o,c,h,a,s,p,v;return!t&&this.length>0?(y=n(this[0]),v=y.data(n.mask.dataName),v?v():undefined):(e=n.extend({autoclear:n.mask.autoclear,placeholder:n.mask.placeholder,completed:null},e),l=n.mask.definitions,o=[],c=s=t.length,h=null,n.each(t.split(""),function(n,t){t=="?"?(s--,c=n):l[t]?(o.push(new RegExp(l[t])),h===null&&(h=o.length-1),n<c&&(a=o.length-1)):o.push(null)}),this.trigger("unmask").each(function(){function tt(){if(e.completed){for(var n=h;n<=a;n++)if(o[n]&&y[n]===w(n))return;e.completed.call(v)}}function w(n){return n<e.placeholder.length?e.placeholder.charAt(n):e.placeholder.charAt(0)}function b(n){while(++n<s&&!o[n]);return n}function ft(n){while(--n>=0&&!o[n]);return n}function it(n,t){var r,i;if(!(n<0)){for(r=n,i=b(t);r<s;r++)if(o[r]){if(i<s&&o[r].test(y[i]))y[r]=y[i],y[i]=w(i);else break;i=b(i)}d();v.caret(Math.max(h,n))}}function et(n){for(var r,u,t=n,i=w(n);t<s;t++)if(o[t])if(r=b(t),u=y[t],y[t]=i,r<s&&o[r].test(u))i=u;else break}function ot(){var t=v.val(),n=v.caret(),i;if(t.length<p.length){for(k(!0);n.begin>0&&!o[n.begin-1];)n.begin--;if(n.begin===0)while(n.begin<h&&!o[n.begin])n.begin++;v.caret(n.begin,n.begin)}else{for(i=k(!0);n.begin<s&&!o[n.begin];)n.begin++;v.caret(n.begin,n.begin)}tt()}function rt(){k();v.val()!=nt&&v.change()}function st(n){if(!v.prop("readonly")){var i=n.which||n.keyCode,f,r,t;p=v.val();i===8||i===46||u&&i===127?(f=v.caret(),r=f.begin,t=f.end,t-r==0&&(r=i!==46?ft(r):t=b(r-1),t=i===46?b(t):t),g(r,t),it(r,t-1),n.preventDefault()):i===13?rt.call(this,n):i===27&&(v.val(nt),v.caret(0,k()),n.preventDefault())}}function ht(t){var f,r,u,e,h,c;v.prop("readonly")||(f=t.which||t.keyCode,r=v.caret(),t.ctrlKey||t.altKey||t.metaKey||f<32)||f&&f!==13&&(r.end-r.begin!=0&&(g(r.begin,r.end),it(r.begin,r.end-1)),u=b(r.begin-1),u<s&&(e=String.fromCharCode(f),o[u].test(e)&&(et(u),y[u]=e,d(),h=b(u),i?(c=function(){n.proxy(n.fn.caret,v,h)()},setTimeout(c,0)):v.caret(h),r.begin<=a&&tt())),t.preventDefault())}function g(n,t){for(var i=n;i<t&&i<s;i++)o[i]&&(y[i]=w(i))}function d(){v.val(y.join(""))}function k(n){for(var r=v.val(),u=-1,f,t=0,i=0;t<s;t++)if(o[t]){for(y[t]=w(t);i++<r.length;)if(f=r.charAt(i-1),o[t].test(f)){y[t]=f;u=t;break}if(i>r.length){g(t+1,s);break}}else y[t]===r.charAt(i)&&i++,t<c&&(u=t);return n?d():u+1<c?e.autoclear||y.join("")===ut?(v.val()&&v.val(""),g(0,s)):d():(d(),v.val(v.val().substring(0,u+1))),c?t:h}var v=n(this),y=n.map(t.split(""),function(n,t){if(n!="?")return l[n]?w(t):n}),ut=y.join(""),nt=v.val();v.data(n.mask.dataName,function(){return n.map(y,function(n,t){return o[t]&&n!=w(t)?n:null}).join("")});v.one("unmask",function(){v.off(".mask").removeData(n.mask.dataName)}).on("focus.mask",function(){if(!v.prop("readonly")){clearTimeout(r);var n;nt=v.val();n=k();r=setTimeout(function(){v.get(0)===document.activeElement&&(d(),n==t.replace("?","").length?v.caret(0,n):v.caret(n))},10)}}).on("blur.mask",rt).on("keydown.mask",st).on("keypress.mask",ht).on("input.mask paste.mask",function(){v.prop("readonly")||setTimeout(function(){var n=k(!0);v.caret(n);tt()},0)});if(f&&i)v.off("input.mask").on("input.mask",ot);k()}))}})}),function(n){function at(n,t){var u,n,e,o,s;if(n)if(n.constructor==String)location.href=n;else if(u=n,u.atomControl)u=u.atomControl,u.refresh?u.refresh(this.get_scope(),this):i.alert("no default action defined");else if(u._element)u.refresh(this.get_scope(),this);else if(typeof u=="function")u.call(this,this.get_scope(),this,t);else{if(u.length){for(ae=new f(u);ae.next();)this.invokeAction(ae.current(),t);return}if(n=u.timeOut||u.timeout,n){e=this;o=100;n.hasOwnProperty("length")&&n.length>1&&(o=n[0],n=n[1]);setTimeout(function(){e.invokeAction(n)},o);return}if(this.set_merge(u),n=u.confirm,n){s="Are you sure?";n.hasOwnProperty("length")&&(n.length>1?(s=n[0],n=n[1]):n=n[0]);var e=this,h=n,c=t;i.confirm(s,function(){e.invokeAction(h,c)})}if(n=u.alert,n&&i.alert(n),n=u.next,n){this.invokeAction(n,t);return}n=u.control;n&&it[n].refresh();n=u.window;n&&r.AtomWindow.openNewWindow({url:n,localScope:!1,opener:this,scope:this.get_scope()});n=u.localWindow;n&&r.AtomWindow.openNewWindow({url:n,localScope:!0,opener:this,scope:this.get_scope()})}}function vt(n,t){function i(n){this._handler=n;var i=this;this.invoke=function(){try{i._handler.apply(i,i.args)}catch(n){console&&console.log(n)}finally{i.timeout=0;i.pending=!1}};this.handler=function(){i.pending||(i.pending=!0,i.args=arguments,i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(i.invoke,t||500))}}var r=new i(n);return r.handler}var t=n.$,o=n.document,w={jsonML:{}},r={},c,a,b,tt,y,AtomEvaluator,h,f,i,s,ot,st,rt,ut,u,k,d,g,AtomBinder,e,ht,it,ct,nt,ft,p,lt,et;n.WebAtoms=r;n.Templates=w;c=w.jsonML;c["WebAtoms.AtomAutoCompleteBox.template"]=[["input",{"data-atom-presenter":"selectionBox",disabled:"disabled",type:"text","data-atom-init":"t1"}],["input",{"data-atom-presenter":"inputBox",type:"text",autocomplete:"off",autocorrect:"off","data-atom-init":"t2"}],["div",{"data-atom-presenter":"itemsPresenter","class":"atom-list-box",style:"position: absolute; z-index: 100;","data-atom-init":"t3"},["div",{"data-atom-template":"itemTemplate",style:"min-width:100px;","data-atom-init":"t4"}]]];c["WebAtoms.AtomCalendar.itemTemplate"]=[["div",{"data-atom-template":"itemTemplate","data-atom-init":"t5"},["span",{"data-atom-init":"t6"}]]];c["WebAtoms.AtomCalendar.template"]=[["section",{"class":"calendar"},["header",{},["button",{"class":"prev","data-atom-init":"t7"}],["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t8"}],["select",{"data-atom-type":"AtomComboBox","class":"year","data-atom-init":"t9"}],["button",{"class":"next","data-atom-init":"t10"}]],["ul",{"class":"days"},["li",{"class":"weekend"},"S"],["li",{},"M"],["li",{},"T"],["li",{},"W"],["li",{},"T"],["li",{},"F"],["li",{"class":"weekend"},"S"]],["section",{"class":"day-list","data-atom-presenter":"itemsPresenter"},]]];c["WebAtoms.AtomCheckBoxList.itemTemplate"]=[["div",{"data-atom-template":"itemTemplate"},["input",{type:"checkbox","data-atom-init":"t13"}],["span",{"data-atom-init":"t14"}]]];c["WebAtoms.AtomDataPager.template"]=[["button",{"class":"atom-pager-first-button",style:"float:left","data-atom-init":"t15"},"First"],["span",{style:"text-align:left"},["button",{"class":"atom-pager-prev-button","data-atom-init":"t16"},"Prev"],["span",{},"Goto: Page"],["select",{"data-atom-type":"AtomComboBox","data-atom-init":"t17"},],["button",{"class":"atom-pager-next-button","data-atom-init":"t18"},"Next"]],["button",{"class":"atom-pager-last-button",style:"float:right","data-atom-init":"t19"},"Last"]];c["WebAtoms.AtomDateField.popupTemplate"]=[["div",{"class":"atom-date-popup","data-atom-init":"t20"},["div",{"class":"atom-date-list-box"},["div",{"class":"calendar","data-atom-presenter":"calendarPresenter"},["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t22"}],["select",{"data-atom-type":"AtomNumberComboBox","class":"year","data-atom-init":"t23"}],["div",{"class":"days"},["span",{"class":"weekend-header"},"S"],["span",{},"M"],["span",{},"T"],["span",{},"W"],["span",{},"T"],["span",{},"F"],["span",{"class":"weekend-header"},"S"]],["div",{"class":"day-list","data-atom-type":"AtomItemsControl","data-atom-presenter":"itemsPresenter","data-atom-init":"t24"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t25"},["span",{"data-atom-init":"t26"}]]]]]]];c["WebAtoms.AtomDateField.template"]=[["div",{"class":"date-label","data-atom-init":"t27"}]];c["WebAtoms.AtomDateListBox.template"]=[["div",{"class":"atom-date-list-box"},["div",{"class":"calendar"},["select",{"data-atom-type":"AtomComboBox","class":"month","data-atom-init":"t28"}],["select",{"data-atom-type":"AtomComboBox","class":"year","data-atom-init":"t29"}],["div",{"class":"days"},["span",{"class":"weekend-header"},"S"],["span",{},"M"],["span",{},"T"],["span",{},"W"],["span",{},"T"],["span",{},"F"],["span",{"class":"weekend-header"},"S"]],["div",{"class":"day-list","data-atom-presenter":"itemsPresenter"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t31"},["span",{"data-atom-init":"t32"}]]]],["div",{"class":"list","data-atom-type":"AtomListBox","data-atom-init":"t33"},["div",{"data-atom-template":"itemTemplate","data-atom-init":"t34"},]]]];c["WebAtoms.AtomItemsControl.itemTemplate"]=[["span",{"data-atom-init":"t35"},"Item"]];c["WebAtoms.AtomLinkBar.itemTemplate"]=[["li",{"data-atom-init":"t36"},["a",{"data-atom-init":"t37"},]]];c["WebAtoms.AtomLinkBar.menuTemplate"]=[["ul",{"class":"menu","data-atom-type":"AtomLinkBar","data-atom-init":"t38"},["li",{"data-atom-template":"itemTemplate"},["a",{"data-atom-init":"t40"}]]]];c["WebAtoms.AtomNavigatorList.detailTemplate"]=[["iframe",{"class":"atom-navigator-list-iframe","data-atom-template":"detailTemplate","data-atom-init":"t41"}]];c["WebAtoms.AtomNavigatorList.template"]=[["div",{"data-atom-type":"AtomViewStack","data-atom-init":"t42"},["div",{"data-atom-type":"AtomDockPanel","data-atom-presenter":"gridPanel"},["div",{"data-atom-dock":"Fill","data-atom-presenter":"gridPresenter","class":"atom-navigator-list-grid"},]],["div",{"data-atom-presenter":"detailView","data-atom-type":"AtomDockPanel","data-atom-init":"t45"},["div",{"data-atom-dock":"Top","data-atom-presenter":"detailHeaderToolbar"},["input",{type:"button",value:"Back",style:"float: left","data-atom-init":"t47"}]]],["div",{"data-atom-presenter":"newView","data-atom-type":"AtomDockPanel","data-atom-init":"t48"},["div",{"data-atom-dock":"Top","data-atom-presenter":"newHeaderToolbar"},["input",{type:"button",value:"Back",style:"float: left","data-atom-init":"t50"}]]]]];c["WebAtoms.AtomRadioButtonList.itemTemplate"]=[["span",{},["input",{type:"radio","data-atom-name":"{$owner.groupName}","data-atom-init":"t51"}],["span",{"data-atom-init":"t52"}]]];c["WebAtoms.AtomSortableColumn.template"]=[["span",{"data-atom-init":"t53"}]];c["WebAtoms.AtomTabControl.template"]=[["div",{"data-atom-type":"AtomDockPanel"},["ul",{"data-atom-dock":"Top","data-atom-type":"AtomToggleButtonBar","data-atom-init":"t55"},["li",{"data-atom-template":"itemTemplate","data-atom-init":"t56"}]],["div",{"data-atom-dock":"Fill","data-atom-type":"AtomViewStack","data-atom-presenter":"itemsPresenter","data-atom-init":"t57"},]]];c["WebAtoms.AtomTimeEditor.template"]=[["span",{},"Hour:"],["input",{type:"number",min:"0",max:"12","data-atom-init":"t58"}],["span",{},"Minute:"],["input",{type:"number",min:"0",max:"59","data-atom-init":"t59"}],["ul",{"data-atom-type":"AtomToggleButtonBar","data-atom-init":"t60"},["li",{"data-atom-template":"itemTemplate","data-atom-init":"t61"}]]];c["WebAtoms.AtomToggleButtonBar.itemTemplate"]=[["li",{"data-atom-init":"t62"},]];c["WebAtoms.AtomWizard.template"]=[["div",{"data-atom-dock":"Fill","data-atom-type":"AtomViewStack","data-atom-presenter":"viewPresenter","data-atom-init":"t63"},],["div",{"data-atom-dock":"Bottom","class":"atom-wizard-command-bar"},["button",{"class":"atom-wizard-back-button","data-atom-init":"t65"},["span",{"data-atom-init":"t66"}]],["button",{"class":"atom-wizard-next-button","data-atom-init":"t67"},["span",{"data-atom-init":"t68"}]]]];c["WebAtoms.AtomYesNoCustom.template"]=[["ul",{"data-atom-type":"AtomYesNoControl","data-atom-presenter":"yesNo","data-atom-init":"t69"}],["input",{style:"vertical-align:top",type:"text","data-atom-presenter":"input","data-atom-init":"t70"}]];c["WebAtoms.AtomApplication.busyTemplate"]=[["div",{style:"position:absolute;left:0px;top:0px;z-index:10000; display:none","data-atom-init":"t71"},["div",{"class":"atom-busy-window",style:"position:absolute","data-atom-init":"t72"},["div",{"class":"atom-busy-image","data-atom-init":"t73"}],["div",{"data-atom-init":"t74"}],["div",{style:"height:3px; background-color:green","data-atom-init":"t75"}]]]];c["WebAtoms.AtomForm.errorTemplate"]=[["section",{"data-atom-type":"AtomItemsControl",style:"overflow:auto","data-atom-init":"t76"},["div",{"data-atom-template":"itemTemplate"},["span",{"data-atom-init":"t78"}]]]];c["WebAtoms.AtomFormGridLayout.fieldTemplate"]=[["table",{"class":"atom-form-grid-row","data-atom-type":"AtomFormField","data-atom-init":"t79"},["tbody",{},["tr",{},["td",{"class":"atom-form-grid-label","data-atom-init":"t80"}],["td",{"class":"atom-form-grid-required","data-atom-init":"t81"},"*"],["td",{"class":"atom-form-grid-content","data-atom-presenter":"contentPresenter","data-atom-init":"t82"},],["td",{"data-atom-init":"t83"},]]]]];c["WebAtoms.AtomFormLayout.fieldTemplate"]=[["tr",{"data-atom-type":"AtomFormField"},["td",{"class":"atom-form-label","data-atom-init":"t85"},["label",{"data-atom-init":"t86"}]],["td",{"class":"atom-form-required","data-atom-init":"t87"},],["td",{"class":"atom-form-content","data-atom-presenter":"contentPresenter"},["span",{style:"background-color:red;color:white; display:inline-block;float:right","data-atom-init":"t89"}]]]];c["WebAtoms.AtomFormVerticalLayout.fieldTemplate"]=[["tr",{"data-atom-type":"AtomFormField"},["td",{},["div",{},["span",{"class":"atom-form-label","data-atom-init":"t91"}],["span",{"class":"atom-form-required","data-atom-init":"t92"}]],["div",{"class":"atom-form-content","data-atom-presenter":"contentPresenter","data-atom-init":"t93"}],["div",{"class":"atom-form-error","data-atom-init":"t94"}]]]];c["WebAtoms.AtomWindow.alertTemplate"]=[["div",{"class":"atom-alert","data-atom-dock":"Fill"},["pre",{"data-atom-init":"t96"},],["div",{"class":"buttons","data-atom-init":"t97"},["button",{"class":"ok","data-atom-init":"t98"},"Ok"],["button",{"class":"yes","data-atom-init":"t99"},"Yes"],["button",{"class":"no","data-atom-init":"t100"},"No"]]]];c["WebAtoms.AtomWindow.frameTemplate"]=[["div",{"class":"atom-window-background","data-atom-init":"t101"},["div",{"class":"atom-window","data-atom-presenter":"windowDiv",style:"position:absolute","data-atom-type":"AtomDockPanel","data-atom-init":"t102"},["div",{"class":"atom-window-title","data-atom-dock":"Top","data-atom-presenter":"windowTitleDiv","data-atom-init":"t103"}],["div",{"class":"atom-window-close-button","data-atom-presenter":"windowCloseButton","data-atom-init":"t104"}]]]];c["WebAtoms.AtomWindow.windowTemplate"]=[["iframe",{"class":"atom-window-frame","data-atom-presenter":"iframe","data-atom-init":"t105"},]];r.PageSetup=r.PageSetup||{},function(){this.t1=function(n){this.bind(n,"styleDisplay",[["isPopupOpen"]],0,function(n){return n?"":"none"});this.bind(n,"value",["selectedText"])};this.t2=function(n){this.bind(n,"placeholder",["placeholder"]);this.bind(n,"value",["displayLabel"],!0,null,"keyup")};this.t3=function(n){this.bind(n,"styleLeft",[["offsetLeft"]],0,function(n){return n+2+"px"});this.bind(n,"styleTop",[["offsetTop"]],0,function(n){return n+24+"px"});this.bind(n,"styleDisplay",[["isPopupOpen"]],0,function(n){return n?"block":"none"})};this.t4=function(n){this.setLocalValue("text",i.get(this,"data")[i.get(this,"templateParent.labelPath")],n)};this.t5=function(n){this.bind(n,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["scope","itemSelected"]],0,function(n,t,i,r){return{weekend:n,other:t,today:i,selected:r}})};this.t6=function(n){this.bind(n,"text",["data","label"])};this.t7=function(n){this.setLocalValue("eventClick",i.get(this,"prevMonthCommand"),n);p.text(n,"<")};this.t8=function(n){this.setLocalValue("items",s.monthList,n);this.bind(n,"value",["templateParent","month"],!0)};this.t9=function(n){this.bind(n,"items",[["value"],["templateParent","startYear"],["value"],["templateParent","endYear"]],0,function(n,t,r,u){return i.range(n+t,r+u)});this.bind(n,"value",["templateParent","year"],!0)};this.t10=function(n){this.setLocalValue("eventClick",i.get(this,"nextMonthCommand"),n);p.text(n,">")};this.t13=function(n){this.bind(n,"checked",["scope","itemSelected"],!0)};this.t14=function(n){this.setLocalValue("text",i.get(this,"data")[i.get(this,"templateParent.labelPath")],n)};this.t15=function(n){this.bind(n,"isEnabled",[["pages","length"],["currentPage"]],0,function(n,t){return n>1&&t});this.setLocalValue("eventClick",i.get(this,"goFirstCommand"),n)};this.t16=function(n){this.setLocalValue("eventClick",i.get(this,"goPrevCommand"),n);this.bind(n,"isEnabled",["currentPage"])};this.t17=function(n){this.bind(n,"items",["atomParent","pages"]);this.bind(n,"value",["atomParent","currentPage"],!0)};this.t18=function(n){this.setLocalValue("eventClick",i.get(this,"goNextCommand"),n);this.bind(n,"isEnabled",[["currentPage"],["pages","length"]],0,function(n,t){return n<t-1})};this.t19=function(n){this.setLocalValue("eventClick",i.get(this,"goLastCommand"),n);this.bind(n,"isEnabled",[["pages","length"],["currentPage"],["pages","length"]],0,function(n,t,i){return n>1&&t<i-1})};this.t20=function(n){this.bind(n,"styleLeft",[["offsetLeft"]],0,function(n){return n+"px"});this.bind(n,"styleTop",[["offsetTop"]],0,function(n){return n+25+"px"});this.bind(n,"class",[["isOpen"]],0,function(n){return n?"popup-open":"popup-closed"})};this.t22=function(n){this.setLocalValue("items",s.monthList,n);this.bind(n,"value",["templateParent","month"],!0)};this.t23=function(n){this.bind(n,"startNumber",[["templateParent","currentYear"],["templateParent","startYear"]],0,function(n,t){return n+t});this.bind(n,"endNumber",[["templateParent","currentYear"],["templateParent","endYear"]],0,function(n,t){return n+t});this.bind(n,"value",["templateParent","year"],!0)};this.t24=function(n){this.bind(n,"items",["templateParent","items"])};this.t25=function(n){this.setLocalValue("eventClick",i.get(this,"templateParent.templateParent.toggleDateCommand"),n);this.bind(n,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["templateParent","templateParent","selectedItems"],["data","value"]],0,function(n,t,r,u,f){return{"list-item":!0,weekend:n,other:t,today:r,selected:i.query(u).any({value:f})}})};this.t26=function(n){this.bind(n,"text",["data","label"])};this.t27=function(n){this.bind(n,"class",[["isOpen"]],0,function(n){return n?"date-label-open":"date-label-closed"});this.bind(n,"eventClick",[["isOpen"]],0,function(n){return{owner:{isOpen:!n}}});this.bind(n,"text",[["selectedItem"],["selectedItem","dateLabel"]],0,function(n,t){return n?t:"SELECT"})};this.t28=function(n){this.setLocalValue("items",s.monthList,n);this.bind(n,"value",["templateParent","month"],!0)};this.t29=function(n){this.bind(n,"items",[["value"],["templateParent","startYear"],["value"],["templateParent","endYear"]],0,function(n,t,r,u){return i.range(n+t,r+u)});this.bind(n,"value",["templateParent","year"],!0)};this.t31=function(n){this.setLocalValue("eventClick",i.get(this,"templateParent.toggleDateCommand"),n);this.bind(n,"data",[["templateParent","items"],["scope","itemIndex"]],0,function(n,t){return n[t]});this.bind(n,"class",[["data","isWeekEnd"],["data","isOtherMonth"],["data","isToday"],["templateParent","selectedItems"],["data","value"]],0,function(n,t,r,u,f){return{"list-item":!0,weekend:n,other:t,today:r,selected:i.query(u).any({value:f})}})};this.t32=function(n){this.bind(n,"text",["data","label"])};this.t33=function(n){this.bind(n,"items",["templateParent","selectedItems"]);this.setLocalValue("labelPath","dateLabel",n);this.setLocalValue("valuePath","date",n);this.bind(n,"value",["templateParent","visibleDate"],!0)};this.t34=function(n){this.setLocalValue("text",i.get(this,"data.dateLabel"),n)};this.t35=function(n){this.bind(n,"text",[["data"],["atomParent","labelPath"]],0,function(n,t){return n[t]})};this.t36=function(n){this.setLocalValue("class",i.get(this,"data")[i.get(this,"templateParent.itemsPath")]?i.get(this,"data")[i.get(this,"templateParent.itemsPath")].length?"sub-menu":"":"",n)};this.t37=function(n){this.setLocalValue("href",i.get(this,"data")[i.get(this,"atomParent.valuePath")],n);this.setLocalValue("target",i.get(this,"data")[i.get(this,"atomParent.targetPath")],n);this.setLocalValue("text",i.get(this,"data")[i.get(this,"atomParent.labelPath")],n)};this.t38=function(n){this.bind(n,"items",[["data"],["templateParent","itemsPath"]],0,function(n,t){return n[t]});this.setLocalValue("menuTemplate",i.get(this,"templateParent.menuTemplate"),n);this.setLocalValue("menuDirection","vertical",n)};this.t40=function(n){this.setLocalValue("href",i.get(this,"data")[i.get(this,"templateParent.valuePath")],n);this.setLocalValue("text",i.get(this,"data")[i.get(this,"templateParent.labelPath")],n);this.setLocalValue("target",i.get(this,"data.target"),n);this.setLocalValue("eventClick",i.get(this,"data.action"),n)};this.t41=function(n){this.bind(n,"src",[["templateParent","displayMode"],["templateParent","displayMode"],["templateParent","newUrl"],["templateParent","detailUrl"]],0,function(n,t,i,r){return n==1?t==2?i:r:"about:none"})};this.t42=function(n){this.bind(n,"selectedIndex",["atomParent","displayMode"])};this.t45=function(n){this.bind(n,"data",["templateParent","selectedItem"])};this.t47=function(n){this.bind(n,"eventClick",["templateParent","backCommand"])};this.t48=function(n){this.bind(n,"data",["templateParent","newItemCopy"])};this.t50=function(n){this.bind(n,"eventClick",["templateParent","cancelAddCommand"])};this.t51=function(n){this.bind(n,"checked",["scope","itemSelected"],!0)};this.t52=function(n){this.setLocalValue("text",i.get(this,"data.label"),n)};this.t53=function(n){this.bind(n,"text",["label"])};this.t55=function(n){this.setLocalValue("showTabs","true",n);this.bind(n,"labelPath",["templateParent","labelPath"]);this.bind(n,"items",["templateParent","items"]);this.bind(n,"selectedIndex",["templateParent","selectedIndex"],!0)};this.t56=function(n){this.bind(n,"text",["data"])};this.t57=function(n){this.bind(n,"selectedIndex",["templateParent","selectedIndex"])};this.t58=function(n){this.bind(n,"value",["hours"],!0)};this.t59=function(n){this.bind(n,"value",["minutes"],!0)};this.t60=function(n){this.setLocalValue("items",[{label:"AM",value:"AM"},{label:"PM",value:"PM"}],n);this.bind(n,"value",["templateParent","ap"],!0)};this.t61=function(n){this.setLocalValue("text",i.get(this,"data.label"),n)};this.t62=function(n){this.setLocalValue("text",i.get(this,"data")[i.get(this,"atomParent.labelPath")],n)};this.t63=function(n){this.bind(n,"selectedIndex",["templateParent","currentStep"],!0)};this.t65=function(n){this.bind(n,"isEnabled",["canMoveBack"]);this.setLocalValue("eventClick",i.get(this,"goPrevCommand"),n);this.bind(n,"styleVisibility",[["currentStep"]],0,function(n){return n?"visible":"hidden"})};this.t66=function(n){this.bind(n,"text",["prevLabel"])};this.t67=function(n){this.bind(n,"class",[["nextClass"],["isLastStep"]],0,function(n,t){return n||(t?"finish-button":"")});this.setLocalValue("eventClick",i.get(this,"nextCommand"),n);this.bind(n,"isEnabled",["nextCommand"])};this.t68=function(n){this.bind(n,"text",[["isLastStep"],["finishLabel"],["nextLabel"]],0,function(n,t,i){return n?t:i})};this.t69=function(n){this.bind(n,"value",["templateParent","hasValue"],!0)};this.t70=function(n){this.bind(n,"isEnabled",["hasValue"]);this.bind(n,"placeholder",["placeholder"])};this.t71=function(n){this.bind(n,"styleWidth",[["appWidth"]],0,function(n){return n+"px"});this.bind(n,"styleHeight",[["appHeight"]],0,function(n){return n+"px"});this.bind(n,"styleDisplay",[["isBusy"]],0,function(n){return n?"block":"none"})};this.t72=function(n){this.bind(n,"styleLeft",[["appWidth"]],0,function(n){return n/2-100+"px"});this.bind(n,"styleTop",[["appHeight"]],0,function(n){return n/2-25+"px"})};this.t73=function(n){p.absPos(n,"12,12,36,36")};this.t74=function(n){p.absPos(n,"56,24,145,null");this.bind(n,"text",[["busyMessage"]],0,function(n){return n||"Loading..."})};this.t75=function(n){p.absPos(n,"0,48");this.bind(n,"styleDisplay",[["isBusy"],["progress"]],0,function(n,t){return n&&t?"block":"none"});this.bind(n,"styleWidth",[["progress"]],0,function(n){return n+"%"})};this.t76=function(n){this.setLocalValue("items",i.get(this,"data"),n)};this.t78=function(n){this.setLocalValue("text",i.get(this,"data.label"),n)};this.t79=function(n){this.bind(n,"class",["fieldClass"]);this.bind(n,"styleDisplay",[["fieldVisible"]],0,function(n){return n?"":"none"})};this.t80=function(n){this.bind(n,"text",["label"]);this.bind(n,"styleMinWidth",[["atomParent","minLabelWidth"],["atomParent","minLabelWidth"]],0,function(n,t){return n?t+"px":undefined})};this.t81=function(n){this.bind(n,"class",[["required"]],0,function(n){return n?"atom-form-grid-required":"atom-form-grid-not-required"})};this.t82=function(n){this.bind(n,"class",[["error"]],0,function(n){return n?"atom-data-error":""})};this.t83=function(n){this.bind(n,"class",[["error"]],0,function(n){return n?"atom-data-error":""});this.bind(n,"text",[["error"]],0,function(n){return n||""});this.bind(n,"styleDisplay",[["error"]],0,function(n){return n?"":"none"})};this.t85=function(n){this.bind(n,"styleMinWidth",[["atomParent","minLabelWidth"]],0,function(n){return n||undefined})};this.t86=function(n){this.setLocalValue("for",i.get(this,"fieldId"),n);this.bind(n,"text",["label"])};this.t87=function(n){this.bind(n,"text",[["required"]],0,function(n){return n?"*":""})};this.t89=function(n){this.bind(n,"text",[["errors"]],0,function(n){return i.csv(n,"label")||""})};this.t91=function(n){this.bind(n,"text",["label"])};this.t92=function(n){this.bind(n,"text",[["required"]],0,function(n){return n?"*":""})};this.t93=function(n){this.bind(n,"class",[["error"]],0,function(n){return n?"atom-data-error":""})};this.t94=function(n){this.bind(n,"text",[["error"]],0,function(n){return n||""})};this.t96=function(n){this.setLocalValue("text",i.get(this,"data.Message"),n)};this.t97=function(n){this.setLocalValue("class",i.get(this,"data.Confirm")?"confirm-buttons":"alert-buttons",n)};this.t98=function(n){this.setLocalValue("eventClick",i.get(this,"templateParent.closeCommand"),n)};this.t99=function(n){this.setLocalValue("eventClick",[{data:{ConfirmValue:!0}},i.get(this,"templateParent.closeCommand")],n)};this.t100=function(n){this.setLocalValue("eventClick",i.get(this,"templateParent.closeCommand"),n)};this.t101=function(n){this.bind(n,"styleWidth",[["appScope","owner","bodyWidth"]],0,function(n){return n+"px"});this.bind(n,"styleHeight",[["appScope","owner","appHeight"]],0,function(n){return n+"px"});this.bind(n,"styleDisplay",[["isOpen"]],0,function(n){return n?"block":"none"})};this.t102=function(n){this.bind(n,"styleWidth",[["atomParent","windowWidth"]],0,function(n){return n+"px"});this.bind(n,"styleHeight",[["atomParent","windowHeight"]],0,function(n){return n+"px"});this.bind(n,"styleLeft",[["appScope","owner","bodyWidth"],["atomParent","windowWidth"]],0,function(n,t){return(n-t)/2+"px"});this.bind(n,"styleTop",[["appScope","owner","bodyHeight"],["atomParent","windowHeight"]],0,function(n,t){return(n-t)/2+"px"})};this.t103=function(n){this.bind(n,"text",["atomParent","title"])};this.t104=function(n){this.setLocalValue("eventClick",i.get(this,"atomParent.cancelCommand"),n)};this.t105=function(n){this.setLocalValue("src",i.get(this,"templateParent.url"),n)}}.call(r.PageSetup,n,r);a={};n.$x=a;a.stop=function(n,t){return function(){if(n)throw new Error(t);}};a.stopIf=n.stop;a.timeout=function(n,t){return function(){var i=this;setTimeout(function(){i.invokeAction(t)},n)}};a.invoke=function(n,t,i){return function(){var r={},u;i!==undefined?(u={},u[t]=i,r[n]=u):r[n]=t;this.invokeAction(r)}};a.data=function(n,t){return a.invoke("data",n,t)};a.scope=function(n,t){return a.invoke("scope",n,t)};a.localScope=function(n,t){return a.invoke("localScope",n,t)};a.appScope=function(n,t){return a.invoke("appScope",n,t)};a.owner=function(n,t){return a.invoke("owner",n,t)};a.if=function(n,t){return n?t:null};a.isValid=function(n){return function(){var t,i;if(this.validate(),t=this.get_errors(),t&&t.length){i=t.map(function(n){return n.label}).join("\n");alert(i);return}this.invokeAction(n)}};a.alert=function(n){return function(){alert(n)}};a.focus=function(n){return function(){var t=n._element||n;t.focus()}};a.clearErrors=function(t){return function(){n.errors.clear(t._element||t,!0)}};a.confirm=function(n,t){return function(){var r=this;return i.confirm(n,function(){r.invokeAction(t)})}};a.window=function(n,t,i,u){var f=n,o=this,e;return arguments.length>1?(f={path:n,prop:t,next:u},i&&(e=f.prop||{},e.data=i,f.prop=e)):f={prop:f,path:f.path,next:f.next,scope:f.scope},function(){r.AtomWindow.openNewWindow({url:f,scope:this.get_scope(),opener:this})}};a.localWindow=function(n,t,i,u){var f=n;return arguments.length>1&&(f={path:n,prop:t,next:u,scope:i}),function(){r.AtomWindow.openNewWindow({url:f,scope:this.get_scope(),localScope:!0,opener:this})}};a.reveal=function(){return function(){}},function(n){var i=function(n){this.a=n;this.i=-1},t,r,u;i.prototype={next:function(){return this.i++,this.i<this.a.length},current:function(){return this.a[this.i]}};t={truef:function(){return!0},falsef:function(){return!1},get:function(n,i){var r,u;if(n)return(r=i.indexOf("."),r===-1)?n[i]:(u=i.substr(0,r),i=i.substr(r+1),t.get(n[u],i))},escapeRegex:function(n,i,r,u){if(!i)return{test:t.falsef};var f=i.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return n&&(f=n+f),r&&(f=f+r),new RegExp(f,u)},compare:function(n,r){var u;switch(n){case"==":case"=":return function(n){return n==r};case"<=":return function(n){return n<=r};case">=":return function(n){return n>=r};case"<":return function(n){return n<r};case">":return function(n){return n>r};case"between":return function(n){return n>=r[0]&&n<=r[1]};case"equals":return r=t.escapeRegex("^",r,"$","i"),function(n){return n?r.test(n):!r};case"contains":return r=t.escapeRegex("",r,"","i"),function(n){return n?r.test(n):!1};case"startswith":return r=t.escapeRegex("^",r,"","i"),function(n){return n?r.test(n):!r};case"endswith":return r=t.escapeRegex("",r,"$","i"),function(n){return n?r.test(n):!r};case"equals":return r=t.escapeRegex("^",r,"$"),function(n){return n?r.test(n):!r};case"containscs":return r=t.escapeRegex("",r,""),function(n){return n?r.test(n):!1};case"startswithcs":return r=t.escapeRegex("^",r,""),function(n){return n?r.test(n):!r};case"endswithcs":return r=t.escapeRegex("",r,"$"),function(n){return n?r.test(n):!r};case"~":return function(n){return r.test(n)};case"in":return function(n){var t,u;if(!n)return!1;for(t=new i(r);t.next();)if(u=t.current(),u==n)return!0;return!1};case"has":return function(n){var t,u;if(!n)return!1;for(t=new i(n);t.next();)if(u=t.current(),u==r)return!0;return!1};case"any":return u=t.filter(r),function(n){var t,r;if(!n)return!1;for(t=new i(n);t.next();)if(r=t.current(),u(r))return!0;return!1};case"all":return u=t.filter(r),function(n){if(!n)return!1;for(var t=new i(n);t.next();)if(!u(item))return!1;return!0};default:return function(){return!1}}},isString:function(n){return typeof n=="string"||n instanceof String},sort:function(n){if(!t.isString(n))return n;var i=n.split(",");return i=i.map(function(n){var t=n.split(" "),i=t[1]||"asc";return{field:t[0],desc:/desc/i.test(i),cs:/^cs/i.test(i)}}),function(n,r){var e,h;if(n==null||n==undefined)return r==null||r==undefined?0:1;if(r==null||r==undefined)return 1;for(e=0;e<i.length;e++){var o=i[e],s=o.field,u=n[s],f=r[s];if(o.desc&&(h=u,u=f,f=h),u!=f){if(!u)return f?-1:0;if(!f)return u?1:0;if(t.isString(u)){if(o.cs)return u.localeCompare(f);if(u=u.toLowerCase(),f=f.toLowerCase(),u==f)continue;return u.localeCompare(f)}}}return 0}},build:function(n,i,r,u,f){var s,a,o,v,e,l,h,c;if(i==="$or"){s=t.filter(r,!0);n.push(function(n){return s(n)});return}if(i==="$and"){s=t.filter(r,!1);n.push(function(n){return s(n)});return}if(i==="$not"){a=t.filter(r,f);n.push(function(n){return!a(n)});return}o=i.split(" ");o.length===1&&(o=i.split(":"));v=o[0];e="==";o.length===2&&(e=o[1]);l=function(n){return t.get(n,v)};e.indexOf("!")!==0?(h=t.compare(e,r),c=function(n){var t=l(n);return h(t)},n.push(c)):(e=e.substr(1),h=t.compare(e,r),c=function(n){var t=l(n);return!h(t)},n.push(c))},filter:function(n,r){var f,u,e;if(n===!1)return t.falsef;if(!n)return t.truef;f=[];for(u in n)n.hasOwnProperty(u)&&(e=n[u],t.build(f,u,e,n,r));return function(n){for(var t=new i(f),e=[],o,u;t.next();)if(o=t.current(),u=o(n),e.push(u),u){if(r)return!0}else if(!r)return!1;for(t=new i(e);t.next();)if(!t.current())return!1;return!0}}};n.$f=t.filter;Array.prototype.filter||(Array.prototype.filter=function(n){for(var i,r=[],t=0;t<this.length;t++)i=this[t],n(i,t)&&r.push(i);return r});r=Array.prototype.filter;Array.prototype.filter=function(n){return n instanceof Function||typeof n=="function"?r.call(this,n):r.call(this,$f(n))};u=Array.prototype.sort;Array.prototype.sort=function(n){var i=t.sort(n);return u.call(this,i)}}(n);b={debug:!1,baseUrl:"",log:"",ajax:{versionUrl:!0,versionKey:"__wav",version:(new Date).toDateString(),headers:{}}};n.AtomConfig=b;tt=function(t){n.console&&console.log(t);b.log+=t+"\r\n"};n.log=tt;y={browserName:"",version:"1.0",majorVersion:1,isMobile:!1,userAgent:"",detect:function(){var o=navigator.appVersion,n=navigator.userAgent;this.userAgent=n;var r=navigator.appName,i=""+parseFloat(navigator.appVersion),u=parseInt(navigator.appVersion,10),e,t,f;(t=n.indexOf("Opera"))!=-1?(r="Opera",i=n.substring(t+6),(t=n.indexOf("Version"))!=-1&&(i=n.substring(t+8))):(t=n.indexOf("MSIE"))!=-1?(r="Microsoft Internet Explorer",i=n.substring(t+5)):(t=n.indexOf("Chrome"))!=-1?(r="Chrome",i=n.substring(t+7)):(t=n.indexOf("Safari"))!=-1?(r="Safari",this.isMobile=n.indexOf("iPhone")!=-1,i=n.substring(t+7),(t=n.indexOf("Version"))!=-1&&(i=n.substring(t+8))):(t=n.indexOf("Firefox"))!=-1?(r="Firefox",i=n.substring(t+8)):(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(r=n.substring(e,t),i=n.substring(t+1),r.toLowerCase()==r.toUpperCase()&&(r=navigator.appName));(f=i.indexOf(";"))!=-1&&(i=i.substring(0,f));(f=i.indexOf(" "))!=-1&&(i=i.substring(0,f));u=parseInt(""+i,10);isNaN(u)&&(i=""+parseFloat(navigator.appVersion),u=parseInt(navigator.appVersion,10));this.browserName=r;this.majorVersion=u;this.isMobile=/android|mobile|ios|iphone/gi.test(n)},isFF:!1,isChrome:!1,isIE:!1,isSafari:!1,isMac:!1,init:function(){this.isMac=/mac os x/gi.test(this.userAgent)&&!/iphone|ipad/gi.test(this.userAgent);switch(this.browserName){case"Firefox":this.supportsUpload=this.majorVersion>=4;this.isFF=!0;break;case"Chrome":this.supportsUpload=this.majorVersion>=6;this.isChrome=!0;break;case"Microsoft Internet Explorer":this.supportsUpload=this.majorVersion>=10;this.isIE=!0;break;case"Safari":this.isSafari=!0;this.isMobile||(this.supportsUpload=this.majorVersion>=5)}this.supportsFlash=!this.isMobile}};n.AtomBrowser=y;y.detect();y.init();AtomEvaluator={ecache:{},becache:{},parse:function(n){var t=this.becache[n];if(t)return t;var u=[],f=[],e=n.replace(/(?:(\$)(window|appScope|scope|data|owner|localScope|templateParent))(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*/gi,function(n){var t="v"+(u.length+1);return n=n.indexOf("$owner.")==0?n.substr(7):n.indexOf("owner.")==0?n.substr(6):n.substr(1),u.push(n.split(".")),f.push(t),t}),r="return "+e+";",o=r;try{r=AtomEvaluator.compile(f,r)}catch(s){i.alert("Error executing \n"+o+"\nOriginal: "+n);throw s;}return t={length:f.length,method:r,path:u,original:e},this.becache[n]=t,t},compile:function(n,t){var r=n.join("-")+":"+t,i=this.ecache[r];return i?i:(n.push("Atom"),n.push("AtomPromise"),n.push("$x"),i=new Function(n,t),this.ecache[r]=i,i)}};n.AtomEvaluator=AtomEvaluator;h=null;y.isIE&&y.majorVersion<9?(h=function(n){this.index=-1;this.nextItem=n.firstChild;this.findNext();this.item=null},h.prototype={findNext:function(){for(var n=this.nextItem;n&&n.nodeType!==1;)n=n.nextSibling;this.nextItem=n;this.index++},isFirst:function(){return this.index===1},isLast:function(){return this.item&&!this.nextItem},next:function(){return(this.item=this.nextItem,!this.item)?!1:(this.nextItem=this.item.nextSibling,this.findNext(),this.item?!0:!1)},current:function(){return this.item}},n.ChildEnumerator=h):(h=function(n){this.nextItem=n.firstElementChild;this.item=null;this.first=!0},h.prototype={isFirst:function(){return!this.item.previousElementSibling},isLast:function(){return this.item&&!this.nextItem},next:function(){return(this.item=this.nextItem,!this.item)?!1:(this.nextItem=this.item.nextElementSibling,this.item?!0:!1)},current:function(){return this.item}},n.ChildEnumerator=h);f=function(){return classCreator("AtomEnumerator",null,function(n){this._array=n;this.i=-1},{next:function(){return this.i=this.i+1,this.i<this._array.length},current:function(){return this._array[this.i]},currentIndex:function(){return this.i},isFirst:function(){return this.i==0},isLast:function(){return this.i==this._array.length-1},reset:function(){this.i=-1}})}();n.AtomEnumerator=f;i={refreshWindowCommand:function(){location.reload(!0)},time:function(){return(new Date).getTime()},get:function(n,t){var r=t.indexOf("."),u;return r!=-1?(u=t.substr(0,r),n=AtomBinder.getValue(n,u),t=t.substr(r+1),i.get(n,t)):AtomBinder.getValue(n,t)},set:function(n,t,r){var u,f;if(n){if(u=t.indexOf("."),u!=-1)return f=t.substr(0,u),n=AtomBinder.getValue(n,f),t=t.substr(u+1),i.set(n,t,r);AtomBinder.setValue(n,t,r)}},csv:function(n,t,r){var u,e,o;for(r||(r=", "),u=[],e=new f(n);e.next();)o=e.current(),u.push(i.get(o,t));return u.join(r)},range:function(n,t,i){var u=[],r;for(i=i||1,r=n;r<=t;r+=i)u.push({label:r,value:r});return u},merge:function(n,t,r,u){var e,f;if(n){if(e=u?AtomBinder.getClone(t):t,r)for(f in e)i.set(n,f,AtomBinder.getValue(e,f));else for(f in e)n[f]=e[f];return n}},url:function(n,t,i){var e=n,f=[],o,u,r;if(t){for(u in t)if(t.hasOwnProperty(u)){if(r=t[u],r===undefined)continue;if(r===null)continue;r&&r.constructor!=String&&typeof r=="object"&&(r=JSON.stringify(r));f.push(u+"="+encodeURIComponent(r))}f.length&&(o=e.indexOf("?"),e+=o==-1?"?":"&");e+=f.join("&")}if(i){f=[];for(u in i)if(i.hasOwnProperty(u)){if(r=i[u],r===undefined||r===null)continue;f.push(u+"="+encodeURIComponent(r))}f.length&&(e+="#"+f.join("&"))}return e},encodeParameters:function(n){var u=[],i,t,r;for(i in n)i.indexOf("_")!=0&&(t=n[i],t!==undefined)&&t!==null&&(r=typeof t,r=="string"||r=="number"||r=="boolean")&&u.push(i+"="+encodeURIComponent(t));return u.join("&")},tableLayout:function(n,t,i){return new r.AtomTableLayout(n,t,i)},toDash:function(n){return n.replace(/([A-Z])/g,function(n){return"-"+n.toLowerCase()})},secureUrl:function(){for(var t,n="",i=0;i<arguments.length;i++){if(t=arguments[i],t===null||t===undefined)return undefined;n+=t}return/^\/\//.test(n)?o.location.protocol+n:("https:"==o.location.protocol&&(n=n.replace(/http\:\/\//,"https://")),n)}};i.resolve=function(n,t){var h=!t,c,u,r,o,s;if(!n)return n;if(h&&(t=new e,t.list=[],t.done=function(r){i.remove(t.list,r);t.list.length==0&&t.pushValue(n)}),c=typeof n,c=="object")if(typeof n.length!="undefined"){for(u=0;u<n.length;u++)if(r=n[u],r){if(o=n,s=u,r instanceof e||r.constructor==e){t.list.push(r);r.failed(function(n){t.done(n)});r.then(function(n){o[s]=n.value();t.done(n)});continue}i.resolve(r,t)}}else for(u in n)if(r=n[u],r){if(r instanceof e||r.constructor==e){t.list.push(r);r.failed(function(n){t.done(n)});o=n;s=u;r.then(function(n){o[s]=n.value();t.done(n)});continue}i.resolve(r,t)}if(t.list.length){if(h)t.onInvoke(function(){for(var n=new f(t.list);n.next();)n.current().invoke(t._invoker)});return t}return n};n.Atom=i,function(){for(var t,f=/\+/g,e=/([^&=]+)=?([^&]*)/g,r=function(n){return decodeURIComponent(n.replace(f," "))},o=n.location.search.substring(1),u={};t=e.exec(o);)u[r(t[1])]=r(t[2]);i.pageQuery=u}();s={zoneOffsetMinutes:(new Date).getTimezoneOffset(),zoneOffset:(new Date).getTimezoneOffset()*6e4,toLocalTime:function(n){return n.toJSON()},m_names:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],setTime:function(n,t){var i,r,f,u;return!n||!t?n:(i=t.split(":"),r=parseInt(i[0]),i=i[1].split(" "),f=parseInt(i[0]),i[1]=="PM"&&r!=12&&(r+=12),u=new Date(n.getFullYear(),n.getMonth(),n.getDate()),u.setHours(r),u.setMinutes(f),u)},toMMDDYY:function(n){var t=n.getMonth()+1,u=n.getFullYear(),i=n.getDate(),r="";return r+=t>9?t:"0"+t,r+="/"+(i>9?i:"0"+i),r+("/"+u)},toShortDateString:function(n){if(!n)return"";if(n.constructor==String)if(/^\/date\(/gi.test(n))n=n.substr(6),n=new Date(parseInt(n,10));else throw new Error("Invalid date format "+n);return this.m_names[n.getMonth()]+" "+n.getDate()+", "+n.getFullYear()},toDateTimeString:function(n){if(!n)return"";n.constructor==String&&(n=n.substr(6),n=new Date(parseInt(n,10)));var t=s.toShortDateString(n);return t+" - "+s.toTimeString(n)},toTimeString:function(n){var i,r,t;return(n=s.parse(n),!n)?"":(i=n.getHours(),r="AM",i==12?r="PM":i>12&&(i=i-12,r="PM"),t=n.getMinutes(),t<10?t="0"+t:(t=t+"",t.length==1&&(t=t+"0")),i+":"+t+" "+r)},smartDate:function(n){var t,i,r;if(!n)return null;if(t=s.parse(n),i=new Date,i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()){r=i.getDate()-t.getDate();switch(r){case-1:return"Tomorrow ("+s.toTimeString(t)+")";case 0:return"Today ("+s.toTimeString(t)+")";case 1:return"Yesterday ("+s.toTimeString(t)+")"}}return s.toDateTimeString(t)},smartDateUTC:function(n){return s.smartDate(n)},jsonDate:function(n){var t=s.parse(n);return{Year:t.getFullYear(),Month:t.getMonth()+1,Date:t.getDate(),Hours:t.getHours(),Minutes:t.getMinutes(),Seconds:t.getSeconds(),Offset:s.zoneOffsetMinutes}},toUTC:function(n){if(!n)return"";n=s.parse(n);return new Date(n.getTime()+s.zoneOffset)},parse:function(n){var u;if(!n)return null;if(n.constructor!==String)return n;if(/^\/date\([\-0-9]+\)\//gi.test(n))n=new Date(parseInt(n.substr(6),10));else{if(/^\/dateiso/gi.test(n)){n=n.substr(9);n=n.substr(0,n.length-1);var r=n.split("T"),t=r[0],i=r[1];return t=t.split("-"),i=i.split(":"),u=new Date(t[0],parseInt(t[1])-1,t[2],i[0],i[1],parseFloat(i[2])),new Date(u.getTime()+s.zoneOffset)}n=Date.parse(n)}return n}};n.AtomDate=s;s.monthList=[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}];ot={toFileSize:function(n){return n?(n.constructor==String&&(n=parseInt(n,10)),n>1073741824)?Math.round(n/1073741824)+" GB":n>1048576?Math.round(n/1048576)+" MB":n>1024?Math.round(n/1024)+" KB":n+" B":""}};n.AtomFileSize=ot;st={toSmallPhoneString:function(n){var t,i;if(!n)return"";t=n.split(":",6);i=t[2];i="("+(/^\+/.test(i)?"":"+")+t[2]+") ";var r=t[3],u=t[4],f=t[5];return r?i+r:""},toPhoneString:function(n){var i;if(!n)return"";var t=n.split(":",6),e="(+"+t[2]+") ",r=t[3],u=t[4],f=t[5];return r?(i=e+r,u&&(i+=" (ext: "+u+")"),f&&(i+=" ("+f+")"),i):""}};n.AtomPhone=st;$f.get=i.get;$f.compileSelect=function(n){return n?n.constructor==String?function(t){return i.get(t,n)}:function(t){var f={},r,u;for(r in n)u=n[r],r=JSON.stringify(r),f[r]=u?i.get(t,u):i.get(t,r);return f}:function(n){return n}};rt={firstOrDefault:function(n){for(var i=$f(n),t;this.next();)if(t=this.current(),i(t))return t;return null},first:function(n){for(var i=$f(n),t;this.next();)if(t=this.current(),i(t))return t;throw new Error("Item not found in collection");},where:function(n){for(var r=$f(n),i=[],t;this.next();)t=this.current(),r(t)&&i.push(t);return new f(i)},toArray:function(){for(var n=[];this.next();)n.push(this.current());return n},any:function(n){return this.firstOrDefault(n)?!0:!1},select:function(n){for(var r=$f.compileSelect(n),t=[],i;this.next();)i=this.current(),t.push(r(i));return new f(t)},join:function(n){for(var t=[];this.next();)t.push(this.current());return t.join(n)},count:function(n){if(n)return this.where(n).count();for(var t=0;this.next();)t++;return t},sum:function(n){for(var r=0,u=this,t;u.next();)t=u.current(),n&&(t=i.get(t,n)),r+=+(t||0);return r},groupBy:function(n){for(var s=$f.compileSelect(n),u=this,f={},e=[];u.next();){var o=u.current(),r=s(o),t=f[r];t||(t=[],f[r]=t,e.push({key:r,items:t}));t.push(o)}return i.query(e)}};n.AtomQuery=rt;for(ut in rt)f.prototype[ut]=rt[ut];i.query=function(n){return n.length!==undefined?new f(n):n};u={nodeValue:y.isIE&&y.majorVersion<9?"nodeValue":"value",attributeMap:function(n,t){var r,i,e={},o=new f(n.attributes);if(t){while(o.next())r=o.current(),i=r.nodeName,/^data\-/i.test(i)&&(i=i.substr(5)),t.test(i)&&(t.lastIndex=0,e[i]={value:r[u.nodeValue],node:r});return e}while(o.next())r=o.current(),i=r.nodeName,/^data\-/i.test(i)&&(i=i.substr(5)),e[i]={value:r[u.nodeValue],node:r};return e},attr:function(n,t,i){if(i!==undefined)return/^(atom|style)\-/.test(t)&&(t="data-"+t),n.setAttribute(t,i),i;return n.getAttribute("data-"+t)||n.getAttribute(t)},removeAttr:function(n,t){n.removeAttribute(t);n.removeAttribute("data-"+t)},getAtomType:function(n){return u.attr(n,"atom-type")},cloneNode:y.isIE&&y.majorVersion<8?function(t){for(var s=n.document,r=s.createElement(t.nodeName),h=new f(t.attributes),e,c,o,i,l;h.next();){e=h.current();try{if(c=e.nodeName,o=e[u.nodeValue],!o)continue;r.setAttribute(c,o)}catch(a){}}for(i=t.firstChild;i;)i.nodeType==3?(l=s.createTextNode(i.nodeValue),r.appendChild(l)):i.nodeType==1&&r.appendChild(u.cloneNode(i)),i=i.nextSibling;return r}:function(n){return n.cloneNode(!0)},findPresenter:function(n){for(var r=new h(n),t,f,i;r.next();){if(t=r.current(),f=u.attr(t,"atom-presenter"),f)return t;if(i=u.findPresenter(t),i)return i}return null},parseUrl:function(n){for(var i={},o=n.split("&"),r=new f(o);r.next();){var e=r.current().split("="),s=e[0],t=e[1];t&&(t=decodeURIComponent(t));t=u.parseValue(t);i[s]=t}return i},parseValue:function(n){var t;return/^[0-9]+$/.test(n)?(t=parseInt(n,10),isNaN(t)||(n=t),n):/^[0-9]+\.[0-9]+/gi.test(n)?(t=parseFloat(n),isNaN(t)||(n=t),n):/true/.test(n)?!0:/false/.test(n)?!1:n},cancelEvent:function(n){var t=n.target;if(!t||!/input/gi.test(t.nodeName)||!/checkbox/gi.test(t.type))return n.preventDefault?n.preventDefault():n.stop(),n.returnValue=!1,n.stopPropagation(),!1},assignID:function(n){return n.id||(n.id="__waID"+u.getNewIndex()),n.id},atomParent:function(t){return t.atomControl?t.atomControl:t===o||t===n||!t.parentNode?null:u.atomParent(t._logicalParent||t.parentNode)},toNumber:function(n){return n?n.constructor==String?parseFloat(n):n:0},isNode:function(t){try{if(n.XMLHttpRequest&&t instanceof XMLHttpRequest)return!0}catch(i){}return t===n||t===o?!0:typeof Node=="object"?t instanceof Node:typeof t=="object"&&typeof t.nodeType=="number"&&typeof t.nodeName=="string"},createDelegate:function(n,t){return this.getDelegate(n,t,!0)},getDelegate:function(n,t,i){var r,u,f;if(t&&t.constructor!=String)throw new Error("methodName has to be string");if(r=n.__delegates,!r){if(!i)return null;r={};n.__delegates=r}if(u=r[t],!u){if(!i)return null;if(f=n[t],!f)throw new Error("method "+t+" not found");u=function(){return f.apply(n,arguments)};r[t]=u}return u},__index:1e3,getNewIndex:function(){return this.__index=this.__index+1,this.__index},contains:function(n,t){for(var r=n.length,i=0,i=0;i<r;i++)if(n[i]==t)return!0;return!1},removeAllChildren:function(n){while(n.hasChildNodes()){var i=n.lastChild;if(!i)break;i.atomControl&&(i.atomControl.dispose(),delete i.atomControl);t(i).remove()}},isWebkit:function(){return n.navigator.userAgent.toLowerCase().indexOf("webkit")==-1?!1:!0},isWeirdControl:function(n){return n.nodeName=="BUTTON"||n.nodeName=="SELECT"||n.nodeName=="INPUT"&&n.getAttribute("type")=="submit"},parseCSS:function(n,t){var i=parseInt(n.css(t),10);return isNaN(i)?0:i},setItemRect:function(n,t,i){var r=n.css("box-sizing")=="border-box",u=this.parseCSS(n,"marginLeft"),o=this.parseCSS(n,"marginRight"),f=this.parseCSS(n,"marginTop"),s=this.parseCSS(n,"marginBottom"),e=this.isWeirdControl(t);i.width&&(i.width-=u+o,r||e||(i.width-=this.parseCSS(n,"borderLeftWidth")+this.parseCSS(n,"borderRightWidth"),i.width-=this.parseCSS(n,"paddingLeft")+this.parseCSS(n,"paddingRight")),i.width<0&&(i.width=0),t.style.width=i.width+"px");i.height&&(i.height-=f+s,r||e||(i.height-=this.parseCSS(n,"borderTopWidth")+this.parseCSS(n,"borderBottomWidth"),i.height-=this.parseCSS(n,"paddingTop")+this.parseCSS(n,"paddingBottom")),i.height<0&&(i.height=0),t.style.height=i.height+"px");i.left&&(i.left+=u,t.style.left=i.left+"px");i.top&&(i.top+=f,t.style.top=i.top+"px")},getPresenterOwner:function(n,t){var i,r;if(n._presenters)for(i=new f(n._presenters);i.next();)if(r=i.current(),r==t)return n;return this.getPresenterOwner(n.get_atomParent(),t)},createCss:function(n){var t,i,r;if(!n)return"";if(n.constructor==String)return n;t=[];for(i in n)(r=n[i],r)&&t.push(i);return t.join(" ")},createControl:function(n,t,i,f){if(!n.atomControl){if(t?t.constructor==String&&(t=r[t]):(t=u.getAtomType(n),t=r[t]),t){var e=new t(n);return i&&(e._data=i),f&&(e._scope=f),e.createChildren(),i&&e.init(),e}return null}}};n.AtomUI=u;u.isIE7=n.navigator.userAgent.indexOf("MSIE 7.0")!=-1;u.isIE8=n.navigator.userAgent.indexOf("MSIE 8.0")!=-1;n.AtomUri=function(n){var i,f="",o="",t=n.split("?");i=t[0];t.length==2?(f=t[1]||"",t=f.split("#"),f=t[0],o=t[1]||""):(t=i.split("#"),i=t[0],o=t[1]||"");var s=location.protocol,e=location.host,h=location.port,r=i.indexOf("//");r!==-1&&(s=i.substr(0,r),i=i.substr(r+2),r=i.indexOf("/"),r!==-1&&(e=i.substr(0,r),i=i.substr(r+1),t=e.split(":"),t.length>1&&(e=t[0],h=t[1])));this.host=e;this.protocol=s;this.port=h;this.path=i;this.query=u.parseUrl(f);this.hash=u.parseUrl(o)};k={stack:[],startOrder:2e3,show:function(n,i,r,u){if(i.style.zOrder=this.startOrder++,r==0){var f=t(n).offset();i.style.position="absolute";i.style.left=f.left+"px";i.style.top=f.top+t(n).outerHeight(!0)+"px"}i.style.visibility="visible";this.stack.push({parent:n,element:i,removeHandler:u})},peek:function(){var n=null;return this.stack.length>0&&(n=this.stack[this.stack.length-1]),n},hide:function(n){var i=this.peek(),t;i&&i.element===n&&(n.style.visibility="hidden",t=this.stack.pop(),t.removeHandler&&t.removeHandler(t.element))},clicked:function(n){var i=n.target,t=k.peek();if(t){while(i&&i!=t.element&&i!=t.parent)i=i.parentNode;i!=t.element&&i!=t.parent&&(t.element.style.visibility="hidden",this.stack.pop(),t.removeHandler&&t.removeHandler(t.element))}}};n.AtomPopup=k;n.simulateParentClick=function(){var n=null,t;try{n=frameElement}catch(i){return}n&&parent&&(t=parent.$,t(frameElement).click(),n.simulateParentClick&&n.simulateParentClick())};t(n).click(function(t){k.clicked(t);n.simulateParentClick()});Array.prototype.enumerator=function(){return new f(this)};Array.prototype.indexOf||(Array.prototype.indexOf=function(n){for(var t=0,t=0;t<this.length;t++)if(n==this[t])return t;return-1});d={split:function(n,i){i&&i.constructor==String&&(i=t.trim(i));for(var o=n.split(i),u=[],e=new f(o),r;e.next();)r=e.current(),r&&r.constructor==String&&(r=t.trim(r)),u.push(r);return u},getValues:function(n,t){var u,i=n,r;if(t)for(i=[],r=new f(n);r.next();)u=r.current(),i.push(u[t]);return i},intersect:function(n,t,i){for(var u=[],e=new f(i),o,r;e.next();)o=e.current(),r=this.getMatch(n,t,o),r!=undefined&&u.push(r);return u},getMatch:function(n,t,i){for(var e=new f(n),r,u;e.next();)if(r=e.current(),u=r,t&&(u=r[t]),u==i)return r},remove:function(n,t){for(var i=new f(n),r;i.next();)if(r=i.current(),r==t){n.splice(i.currentIndex(),1);return}}};n.AtomArray=d;g=function(){return classCreator("WebAtoms.AtomScope",null,function(n,t,i){this.owner=n;this.parent=t;i&&(this.__application=i);this.__application==this.owner&&(this._v=0,this.refreshCommand=function(){appScope._v=appScope._v+1;AtomBinder.refreshValue(appScope,"_v")});this._refreshValue=function(n){AtomBinder.refreshValue(this,n);this.__application===this.owner&&this.__application._onRefreshValue(this,n)}},{setValue:function(n,t,i){if(AtomBinder.getValue(this,n)==t){i&&this._refreshValue(n);return}var r=this["set_"+n];r?r.apply(this,[t]):this[n]=t;this._refreshValue(n)}})}();AtomBinder={getClone:function(n){var r={},i,t,u;if(typeof n=="object"){typeof n.length!="undefined"&&(r=[]);for(i in n)if(t=n[i],t!==undefined){if(t===null){r[i]=null;continue}/^\_\$\_/gi.test(i)||(u=typeof t,u=="object"?r[i]=t.constructor==Date?"/DateISO("+s.toLocalTime(t)+")/":AtomBinder.getClone(t):u=="string"?r[i]=t:u=="number"?r[i]=t:u=="boolean"?r[i]=t==!0?!0:!1:u=="date"&&(r[i]=t.getTime()))}}return r},setValue:function(n,t,i){var r,u;(n||i!==undefined)&&(r=AtomBinder.getValue(n,t),r!==i)&&(u=n["set_"+t],u?u.apply(n,[i]):n[t]=i,AtomBinder.refreshValue(n,t,r,i))},refreshValue:function(n,t){var i=AtomBinder.get_WatchHandler(n,t),r,u;if(i!=undefined&&i!=null){for(r=new f(i);r.next();)u=r.current(),u(n,t);n._$_watcher&&n._$_watcher._onRefreshValue(n,t)}},getValue:function(n,t){if(n==null)return null;var i=n["get_"+t];return i?i.apply(n):n[t]},add_WatchHandler:function(n,t,i){if(n!=null){var r=AtomBinder.get_WatchHandler(n,t);r.push(i)}},get_WatchHandler:function(n,t){var i,r;return n==null?null:(i=n._$_handlers,i||(i={},n._$_handlers=i),r=i[t],(r==undefined||r==null)&&(r=[],i[t]=r),r)},remove_WatchHandler:function(n,t,i){var r,u;if(n!=null&&n._$_handlers!==undefined&&n._$_handlers!==null&&(r=n._$_handlers[t],r!=undefined&&r!=null))for(u=new f(r);u.next();)if(u.current()==i){r.splice(u.currentIndex(),1);return}},invokeItemsEvent:function(n,t,i,r){var e=AtomBinder.get_WatchHandler(n,"_items"),u,o;if(e){for(u=new f(e);u.next();)o=u.current(),o(t,i,r);n._$_watcher&&n._$_watcher._onRefreshItems(n,t,i,r);AtomBinder.refreshValue(n,"length")}},clear:function(n){n.length=0;AtomBinder.invokeItemsEvent(n,"refresh",0,null)},addItem:function(n,t){var i=n.length;n.push(t);AtomBinder.invokeItemsEvent(n,"add",i,t)},insertItem:function(n,t,i){n.splice(t,0,i);AtomBinder.invokeItemsEvent(n,"add",t,i)},addItems:function(n,t){for(var i=new f(t);i.next();)AtomBinder.addItem(n,i.current())},removeItem:function(n,t){var i=n.indexOf(t);i!=-1&&(n.splice(i,1),AtomBinder.invokeItemsEvent(n,"remove",i,t))},removeAtIndex:function(n,t){if(t!=-1){var i=n[t];n.splice(t,1);AtomBinder.invokeItemsEvent(n,"remove",t,i)}},refreshItems:function(n){AtomBinder.invokeItemsEvent(n,"refresh",-1,null)},add_CollectionChanged:function(n,t){if(n!=null){var i=AtomBinder.get_WatchHandler(n,"_items");i.push(t)}},remove_CollectionChanged:function(n,t){var u,i,r;if(n!=null&&n._$_handlers&&(u="_items",i=n._$_handlers[u],i!=undefined&&i!=null))for(r=new f(i);r.next();)if(r.current()==t){i.splice(r.currentIndex(),1);return}},setError:function(n,t,i){var r=AtomBinder.getValue(n,"__errors");r||AtomBinder.setValue(n,"__errors",{});AtomBinder.setValue(r,t,i)}};n.AtomBinder=AtomBinder;i.clone=AtomBinder.getClone;i.add=AtomBinder.addItem;i.insert=AtomBinder.insertItem;i.remove=AtomBinder.removeItem;i.refresh=AtomBinder.refreshValue;i.refreshArray=AtomBinder.refreshItems;i.clearArray=AtomBinder.clear,function(){return classCreator("WebAtoms.AtomComponent",null,function(){this._eventHandlers=[]},{bindEvent:function(n,i,r,f,e){var s,o;n!=null&&(typeof r=="function"&&(e=r),e=e||u.createDelegate(this,r),s={element:n,name:i,methodName:r,handler:e},f&&(s.key=f),u.isNode(n)?t(n).bind(i,null,e):n.addEventListener?n.addEventListener(i,e,!1):(o=n["add_"+i],o==null?(o=AtomBinder["add_"+i],f?o.apply(AtomBinder,[n,f,e]):o.apply(AtomBinder,[n,e])):o.apply(n,[e])),this._eventHandlers.push(s))},unbindEvent:function(n,i,r,e){for(var h=new f(this._eventHandlers),c=[],s,o;h.next();)(o=h.current(),n&&n!==o.element)||i&&i!==o.name||r&&r!==o.methodName||e&&e!==o.key||(u.isNode(o.element)?t(o.element).unbind(o.name,o.handler):o.element.removeEventListener?o.element.removeEventListener(i,o.handler,!1):(s=o.element["remove_"+o.name],s==null?(s=AtomBinder["remove_"+o.name],o.key?s.apply(AtomBinder,[o.element,o.key,o.handler]):s.apply(AtomBinder,[o.element,o.handler])):s.apply(o.element,[o.handler])),c.push(o));if(c.length==this._eventHandlers.length)this._eventHandlers.length=0;else for(h=new f(c);h.next();)o=h.current(),d.remove(this._eventHandlers,o)},init:function(){},dispose:function(){this.unbindEvent(null,null,null);this.__delegates&&(this.__delegates=null)}})}();e=function(){this._success=[];this._failed=[];this._cached=!1;this._process=null;this._calls=0;this._showProgress=!0;this._showError=!0;var n=this;this.success=function(){n.onSuccess.apply(n,arguments)};this.error=function(){n.onError.apply(n,arguments)}};n.AtomPromise=e;e.prototype={onSuccess:function(n){var i,t;for(this._value=n,this._process&&(this._value=this._process(this._value)),i=this._success,t=0;t<i.length;t++)i[t](this)},onError:function(){var t,n;for(this.errors=arguments,t=this._failed,n=0;n<t.length;n++)t[n](this)},then:function(n){return this._success.push(n),this},process:function(n){return this._process=n,this},failed:function(n){return this._failed.push(n),this},value:function(n){if(n!==undefined){this._value=n;return}return this._value},onInvoke:function(n){return this._invoke=n,this},invoke:function(){if(!this._persist)return this.invokePromise(),this;var n=this;return this.promiseTimeout=setTimeout(function(){n.invokePromise()},100),this},invokePromise:function(){if(this.promiseTimeout=null,this._showProgress&&(atomApplication.setBusy(!0),this._calls===0)){var n=function(){atomApplication.setBusy(!1)};this.then(n);this.failed(n)}return this._calls++,this._invoke(this),this},pushValue:function(n){var t=this;this._cached=!0;setTimeout(function(){t.onSuccess.apply(t,[n])},1)},showProgress:function(n){return this._showProgress=n,this},showError:function(n){return this._showError=n,this},persist:function(n){return this._persist=n===undefined?!0:n,this},abort:function(){if(this.promiseTimeout){clearTimeout(this.promiseTimeout);this.promiseTimeout=null;return}this._failed.length=0;this._success.length=0;this._showProgress&&atomApplication.setBusy(!1);this.handle&&this.handle.abort()}};e.getUrl=function(n){var t=location.href,i=t.indexOf("#");return i!==-1&&(t=t.substr(0,i)),n?(i=t.lastIndexOf("/"),i!==-1&&(t=t.substr(0,i+1)),/^(http|https)\:\/\//gi.test(n))?n:/^\//gi.test(n)?n:/^\./gi.test(n)?(n=n.substr(1),/\/$/gi.test(t)&&/^\//gi.test(n)&&(n=n.substr(1)),t+n):t+n:t};e.parseDates=function(n){var u,t,i,r;if(!n)return n;if(u=typeof n,u==="object"){if(typeof n.length!="undefined"){for(t=0;t<n.length;t++)n[t]=e.parseDates(n[t]);return n}for(i in n)(r=n[i],r)&&(n[i]=e.parseDates(r))}return(typeof n=="string"||n.constructor===String)&&/^\/date\(/gi.test(n)&&/\)\/$/gi.test(n)?s.parse(n):n};e.ajax=function(n,r,u){var o=new e,k,a,v,y,s,l,d,p,g,w,nt,h,c;if(u||(u={type:"GET",dataType:"text",data:null}),b.ajax.versionUrl&&u.versionUrl!==undefined&&u.versionUrl&&(r=r||{},r[b.ajax.versionKey]=b.ajax.version),u.success=o.success,u.error=o.error,u.cache===undefined&&(u.cache=!1),k=n,a=b.ajax.headers,a){u.headers||(u.headers={});for(h in a)c=a[h],u.headers[h]=c,b.debug&&tt("Header set: "+h+"="+c)}if(v=b.ajax.statusCode,v){y=u.statusCode||{};for(h in v)c=v[h],y[h]||(y[h]=c);u.statusCode=y}if(s=u,l=s.data,l&&(s.data=AtomBinder.getClone(l)),d=b.ajax.jsonPostEncode,d?s=d(s):s.data={formModel:JSON.stringify(s.data)},p=s.attachments,p&&p.length){for(g=new FormData,w=new f(p);w.next();)g.append("file"+w.currentIndex(),w.current());if(l)for(h in l)g.append(h,l[h]);s.type="POST";s.xhr=function(){var n=t.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(n){if(n.lengthComputable){var t=Math.round(n.loaded*100/n.total);AtomBinder.setValue(atomApplication,"progress",t)}},!1),n};s.cache=!1;s.contentType=!1;s.processData=!1}if(r){if(nt={},!s.sendRawQueryString)for(h in r){if(c=r[h],c&&typeof c=="object"){if(c=JSON.stringify(AtomBinder.getClone(c)),c===undefined)continue;if(c===null)continue}nt[h]=c}k=i.url(n,nt)}if(n)o.onInvoke(function(){o.handle=t.ajax(k,s)});return o.failed(function(){var n=o.errors[0].responseText;n&&o.errors[2]==="Internal Server Error"||(n=o.errors[2]);o.error={msg:n};o._showError&&o.error.msg&&i.alert(o.error.msg)}),o.then(function(n){var t=n.value();t=e.parseDates(t);t&&t.items&&t.merge&&(t.items.total=t.total,t=t.items,n.value(t))}),o.showError(!0),o.showProgress(!0),o};e.get=function(n,t,i){return i=i||{},i.type=i.type||"get",i.dataType=i.dataType||"text",e.ajax(n,t,i,"get")};e.plugins={};e.json=function(n,t,i){var r,u,f;return i=i||{},i.type=i.type||"get",i.dataType=i.dataType||"json",r=null,u=n.indexOf("://"),u!==-1&&(f=n.substr(0,u),/http|https/i.test(f)||(n=n.substr(u+3),r=e.plugins[f])),r=r||e.ajax,r(n,t,i,"json")};e.cache={};e.cacheInProgress={};e.cachedPromise=function(t,i){var r=e.cache[t];if(!r&&n.sessionStorage&&(r=n.sessionStorage["__AP"+t],r&&(r=JSON.parse(r),e.cache[t]=r)),r){i.onInvoke(function(){i.pushValue(r)});return i}return i.then(function(i){e.cache[t]=i.value();n.sessionStorage&&(n.sessionStorage["__AP"+t]=JSON.stringify(i.value()))}),i};e.cachedJson=function(n,t,i){var o=new Date,f=b.ajax.version,r=b.ajax.versionKey+"="+f,u;return n.indexOf("?")===-1?r="?"+r:/\&$/.test(n)||(r="&"+r),n+=r,i=i||{},i.cache=!0,i.ifModified=!0,i.versionUrl=!1,u=e.ajax(n,t,i,"json"),e.cachedPromise(n,u)};e.configCache={};e.configLabel=function(n,t,i){var r;if(t===null||t===undefined)return"";i=i||{};var s=i.valuePath||"value",u=i.labelPath||"label",o=i.isNumber||!1;o&&typeof t!="number"&&(t=parseFloat(t));r=new e;r.onInvoke(function(){var i=e.configCache[n],h;if(i){i=i[t];i=i?i[u]:"";r.pushValue(i);return}h=e.cachedJson(n);h.then(function(i){for(var c="",h={},a=new f(i.value()),l;a.next();)l=a.current(),c=l[s],o&&typeof c!="number"&&(c=parseFloat(c)),h[c]=l;e.configCache[n]=h;h=h[t];h=h?h[u]:"";r.pushValue(h)});h.invoke()});return r};e.prototype.insertItem=function(n,t,i){return this.then(function(r){var u=r.value();u._$_itemInserted||(i&&(u=u[i]),n===-1?u.push(t):u.splice(n||0,0,t),u._$_itemInserted=!0)})};ht={list:function(){},add:function(){},remove:function(){},clear:function(){},set:function(){},get:function(){}};e.plugins["local-storage"]=function(n,t,i){var r=n.split("/"),f=r[0],o=r[1],u=new e;u.onInvoke(function(n){var r=ht,u=r[o](f,t,i.data);n.pushValue(u)});return u},function(n){return classCreatorEx({name:"WebAtoms.AtomBinding",base:n,start:function(n,i,r,u,e,o,s,h){var l,a,v,c;if(this.element=i,this.control=n,this.vf=s,this.key=r,this.events=h,t.isArray(u)){for(this.pathList=[],this.path=[],c=new f(u);c.next();){if(l=c.current(),!t.isArray(l)){this.path.push({path:l,value:null});continue}for(a=new f(l),v=[];a.next();)v.push({path:a.current(),value:null});this.pathList.push(v)}this.path.length?this.pathList=null:this.path=null}else for(c=new f(u.split(".")),this.path=[];c.next();)this.path.push({path:c.current(),value:null});this.twoWays=e;this.jq=o;this._isUpdating=!1},methods:{onPropChanged:function(){var n;if(this.path!=null&&this.path.length!=0){for(var u=new f(this.path),i=this.control,r=null;u.next();){if(r=u.current(),r.value=i,!i)return;u.isLast()||(i=AtomBinder.getValue(i,r.path))}if(n=null,this.jq)switch(this.key){case"valueAsDate":n=this.element.valueAsDate;break;case"checked":n=this.element.checked?!0:!1;break;default:n=t(this.element).val()}else n=AtomBinder.getValue(this.control,this.key);AtomBinder.setValue(i,r.path,n)}},onDataChanged:function(){var t,i,r,n;if(!this._isUpdating&&arguments!==undefined&&arguments.length!=0)if(i=this.control,this.pathList){for(n=[],t=new f(this.pathList);t.next();)n.push(this.evaluate(i,t.current()));for(t=new f(n);t.next();)if(t.current()===undefined)return;this.setValue(n)}else r=this.path,n=this.evaluate(i,r),n!==undefined&&this.setValue(n)},evaluate:function(n,i){for(var u=null,r=null,e=new f(i),o;n&&e.next();)r=e.current(),u=AtomBinder.getValue(n,r.path),/scope|appScope|atomParent|templateParent|localScope/gi.test(r.path)||(o=this,r.value?r.value!=n&&(this.unbindEvent(r.value,"WatchHandler",null,r.path),this.bindEvent(n,"WatchHandler","onDataChanged",r.path)):this.bindEvent(n,"WatchHandler","onDataChanged",r.path)),r.value=n,n=u;return u===undefined&&b.debug&&tt("Undefined:"+this.control._element.id+" -> "+t.map(i,function(n){return n.path}).join(".")),u},onValChanged:function(){var n=this;r.dispatcher.callLater(function(){n.onPropChanged(null,null)})},setup:function(){if(this.twoWays)if(this.jq){if(this.bindEvent(this.element,"change","onValChanged"),this.bindEvent(this.element,"blur","onValChanged"),this.events)for(var n=new f(this.events.split(","));n.next();)this.bindEvent(this.element,n.current(),"onValChanged")}else this.bindEvent(this.control,"WatchHandler","onPropChanged",this.key);this.onDataChanged(this,null)},setValue:function(n){!this.pathList&&this.vf&&(n=[n]);this.vf&&(n.push(i),n.push(e),n.push(a),n=this.vf.apply(this,n));n instanceof e&&(n._persist=!0);this._lastValue=n;this._isUpdating=!0;this.control.setLocalValue(this.key,n,this.element,!0);this._isUpdating=!1}}})}(r.AtomComponent.prototype);it={};n.allControls=it,function(i){return classCreator("WebAtoms.AtomDispatcher",i,function(){this._paused=!1;this.head=null;this.tail=null;this.onTimeout=function(){if(!this._paused&&this.head){var t=this.head;this.head=t.next;t.next=null;this.head||(this.tail=null);t();n.setTimeout(this._onTimeout,1)}};var t=this;this._onTimeout=function(){t.onTimeout()}},{pause:function(){this._paused=!0},start:function(){this._paused=!1;n.setTimeout(this._onTimeout,1)},callLater:function(n){this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n);this._paused||this.start()},setupControls:function(){var n=t("[data-atom-type],[atom-type]").first()[0],i,f,e;(n.atomControl==undefined||n.atomControl==null)&&(i=u.getAtomType(n),t(n).removeAttr("atom-type"),t(n).removeAttr("data-atom-type"),f=new r[i](n),f.setup(),e=this,this.callLater(function(){e.callLater(function(){var n=atomApplication._element;(n.style.visibility=="hidden"||t(n).css("visibility")=="hidden")&&(n.style.visibility="visible",n.atomControl.updateUI())})}))}})}();r.dispatcher=new r.AtomDispatcher;ct=function(){return createClass({name:"AtomValidator",start:function(n){this.value=n;this.list={};this.errors=[]},methods:{dispose:function(){this.value=null;this.errors=null;this.list=null},set:function(n,t){this.list[n]=t},reset:function(){this.errors=null;this.invoke(!0);this.refresh()},clear:function(){this.errors=[]},invoke:function(n){var i,r,u,f;if(this.refreshing||!n&&this.errors)return this.errors;if(i=[],u=this.list.invalid,u!==undefined)return u?(r=u(),r&&(t.isArray(r)?i=i.concat(r):i.push(r)),this.errors=i,i):(this.errors=i,i);for(f in this.list)(r=this.list[f],r)&&(r=r(),r&&(t.isArray(r)?i=i.concat(r):i.push(r)));return i.length?(this.errors=i,i):null},refresh:function(n){var t,i;if(!this.refreshing){this.refreshing=!0;try{n=n||this.value;t=n.atomControl;t&&AtomBinder.refreshValue(t,"errors")}finally{this.refreshing=!1}i=n._logicalParent||n.parentNode;i&&this.refresh(i)}}}})}(n);n.errors={set:function(n,t,i){var r=n.atomValidator;r||(r=new ct(n),n.atomValidator=r);r.set(t,i)},clear:function(n,t){var r=n.atomValidator,i;if(r&&r.clear(),this.refresh(n),t)for(i=new h(n);i.next();)this.clear(i.current(),t)},get:function(n,t){var i=[],e=n.atomValidator,r,f,u;if(e&&(r=e.invoke(),r&&r.length&&(i=i.concat(r.filter(function(n){return n}).map(function(t){return{label:t,value:n}}))),i&&i.length))return i;if(t)for(f=new h(n);f.next();)u=this.get(f.current(),t),u&&u.length&&(i=i.concat(u));return i},refresh:function(n){var t=n.atomValidator;t&&t.refresh()},reset:function(n){var t=n.atomValidator;t&&t.reset()},validate:function(n){var i=n.atomValidator,t,r;if(i){i.reset();return}for(t=new h(n);t.next();)r=t.current(),this.validate(r)}};nt=n.errors,function(t){return classCreator("WebAtoms.AtomUIComponent",t,function(){},{get_owner:function(){return this},get_appScope:function(){return appScope},get_scope:function(){if(this._scope===undefined){var n=this.get_atomParent(this._element._logicalParent||this._element.parentNode);return n?n._localScope||n.get_scope():appScope}return this._scope},get_localScope:function(){if(this._localScope===undefined){var n=this.get_atomParent(this._element._logicalParent||this._element.parentNode);if(n)return n.get_localScope();throw new Error("Local Scope does not exist");}return this._localScope},set_scope:function(t){var u=this._localScope||this.get_scope(),i,r;for(i in t){if(/^(application|owner|app|parent)$/gi.test(i))throw new Error("Invalid name for the scope property");(r=t[i],u!=n.appScope||n.atomApplication._ready||i.indexOf("_")!=0&&r!==undefined&&r!==null&&/string|number|boolean/i.test(typeof r)&&(atomApplication._defaultScope[i]=r),u[i]===undefined)&&(u[i]=r)}},get_name:function(){return this._name},getTemplate:function(n){var t=this["_"+n];return t!==undefined&&t!==null?t:(t=w.get(this.constructor,n),!t)?null:(this["_"+n]=t,t)}},{next:null,value:undefined})}(r.AtomComponent.prototype);w.compiled={};w.compileElement=function(n){var i=new f(n),t,r,u;if(i.next(),t=i.current(),r=o.createElement(t),!i.next())return r;if(t=i.current(),t)for(u in t)r.setAttribute(u,t[u]);while(i.next()){if(t=i.current(),!t)break;t.constructor==String?r.appendChild(o.createTextNode(t)):r.appendChild(w.compileElement(t))}return r};w.compileJsonML=function(n){if(n.length==1)return w.compileElement(n[0]);for(var t=[],i=new f(n);i.next();)t.push(w.compileElement(i.current()));return t};w.compile=function(n,i,r){var f=o.createElement("div");return f.innerHTML=r,t(f).children().length==1&&(r=u.cloneNode(f.firstElementChild||f.children[0])),r};w.get=function(n,t){var r=n.__typeName+"."+t,i=this.compiled[r];return i?i:(i=w.jsonML[r],i?i=w.compileJsonML(i):n.__baseType&&(i=w.get(n.__baseType,t)),!i)?null:(this.compiled[r]=i,i)};w.compileType=function(n){var r=n.__typeName,u=r.split("."),t,f,o,e,i;if(u=u[u.length-1],t=this.compiled[r],t)return t;if(t={},f=this[r]||this[u],f)for(i in f)t[i]=this.compile(n,i,f[i]);if(n.__baseType){o=this.compileType(n.__baseType);for(e in o)t[e]||(t[e]=o[e])}return this.compiled[r]=t,i=this,delete i[r],delete i[u],t};ft={"{":function(n,t,r,u){var o,h,c,s;if(r=r.substr(1,r.length-2),o=AtomEvaluator.parse(r),o.path)for(h=new f(o.path),r=[];h.next();){for(c=new f(h.current()),s=n;c.next();)s=AtomBinder.getValue(s,c.current());r.push(s)}else r=[r];r.push(i);r.push(e);r.push(a);r=o.method.apply(null,r);n.setLocalValue(t,r,u)},"[":function(ctrl,key,value,element){value=value.substr(1,value.length-2);var be=AtomEvaluator.parse(value);be.length==0?(value=eval(value),AtomBinder.setValue(ctrl,key,value)):be.length==1&&be.path[0]==be.original?ctrl.bind(element,key,value,!1):ctrl.bind(element,key,be.path,!1,be.method)},"$[":function(n,t,i,r){var f=i.lastIndexOf("]"),u=null;f<i.length-1&&(u=i.substr(f+2),u=u.substr(0,u.length-1));i=i.substr(0,f);i=i.substr(2);/^(@|\$)/g.test(i)&&(i=i.substr(1));n.bind(r,t,i,!0,null,u)},"^[":function(n,t,i,r){i=i.substr(2,i.length-3);/^(@|\$)/g.test(i)&&(i=i.substr(1));n.bind(r,t,i,!0,null,"keyup,keydown,keypress,blur,click")}};p={any:function(n,t,i){u.attr(n,i,t)},isEnabled:function(n,t){t?u.removeAttr(n,"disabled"):u.attr(n,"disabled","disabled")},checked:function(n,t){n.checked!=t&&(n.checked=t?!0:!1)},value:function(n,i){/date|datetime/gi.test(n.type)?n.valueAsDate=s.parse(i):t(n).val(i)},valueAsDate:function(n,t){n.valueAsDate=s.parse(t)},text:function(n,t){n.innerHTML="";var i=o.createTextNode(t);n.appendChild(i)},error:function(n,t){var i=t;typeof i!="function"&&(i=function(){return t});nt.set(n,"error",i)},validate:function(n){var e=n.control,r=n.element,f=n.key,o=n.value,t=n.eventName,s=n.valueFunction,h=function(){var t=s.call(e,r);return n.validator(t)},u;if(o){if(nt.set(r,f,h),t)for(u=i.query(t.split(","));u.next();)t=u.current(),e.bindEvent(r,t,function(){nt.reset(r)},f)}else if(nt.set(r,f,null),t)for(u=i.query(t.split(","));u.next();)t=u.current(),e.unbindEvent(r,t,null,f)},invalid:function(n,i){var r=this;p.validate({value:i,key:"invalid",valueFunction:function(){return i},validator:function(n){return n&&t.isArray(n)?n.join(","):n},control:this,element:n});this._created&&nt.reset(n)},required:function(n,i){if(this._element==n&&this.get_value){i?this.bind(this._element,"invalid",[["value"]],!1,function(n){return n?null:"Required"}):this.clearBinding(this._element,"invalid");return}if(/input|textarea|select/i.test(n.tagName)){var r=function(){return t(n).val()},u=function(n){return n?null:"Required"};p.validate({control:this,element:n,key:"required",value:i,eventName:"change,blur",valueFunction:r,validator:u})}},regex:function(n,value){var i=function(){return t(n).val()},r=function(v){var r=value;return(typeof r=="string"||r.constructor==String)&&(/^\//.test(r)||/(\/)|(\/i)$/.test(r)||(r="/"+r+"/"),r=eval(r)),r.test(v)?null:"Invalid"};p.validate({control:this,element:n,value:value,key:"regex",eventName:"change,blur",valueFunction:i,validator:r})},dataType:function(n,i){var r=function(){return t(n).val()},u=function(n){var t=null,r="Invalid";return/email/i.test(i)&&(t=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,r="Invalid email"),t.test(n)?null:r};p.validate({control:this,element:n,value:i,key:"dataType",eventName:"change,blur",valueFunction:r,validator:u})},mask:function(n,i){i?i.constructor===String?t(n).mask(i):t(n).mask(i.mask,i.settings):t(n).unmask()},html:function(n,t){n.innerHTML=t},absPos:function(n,t){p.setPosition(!0,n,t)},relPos:function(n,t){p.setPosition(!1,n,t)},"class":function(n,i){n.atomClass&&t(n).removeClass(n.atomClass);i&&(i=u.createCss(i),i&&t(n).addClass(i),n.atomClass=i)},setPosition:function(a,e,val){var l=val,left,top,width,height;l.constructor==String&&(l=eval("["+l+"]"));e.style.position=a?"absolute":"relative";left=l[0];top=l[1];left!==null&&(e.style.left=left+"px");top!==null&&(e.style.top=top+"px");l.length>2&&(width=l[2],height=l[3],width!==undefined&&width!==null&&(e.style.width=width+"px"),height!==undefined&&height!==null&&(e.style.height=height+"px"))}};n.AtomProperties=p,function(s){return classCreatorEx({name:"WebAtoms.AtomControl",base:s,start:function(n){n.atomControl=this;this._element=n;this.dispatcher=r.dispatcher;this.bindings=[];this._isVisible=!0;var t=n.id;t&&appScope&&(/^\_\_waID/.test(t)||(appScope[t]=this));u.assignID(n);it[t]=this},properties:{layout:null,loadNext:null,next:null,merge:undefined,value:undefined},methods:{set_merge:function(n){var t,r,f,u;if((this._mergeData2=null,n)&&(t=n.data,t&&(i.merge(this.get_data(),t,!0),this._mergeData2=t),t=n.scope,t&&i.merge(this.get_scope(),t,!0),t=n.appScope,t&&i.merge(this.get_appScope(),t,!0),t=n.localScope,t&&i.merge(this.get_localScope(),t,!0),t=n.owner,t&&i.merge(this,t,!0),r=n.timeOut||n.timeout,r)){f=this;u=100;r.hasOwnProperty("length")&&r.length>1&&(u=r[0],r=r[1]);setTimeout(function(){f.set_merge(r)},u);return}},invokeAction:function(n,t){try{at.call(this,n,t)}catch(i){alert(i);console.error&&console.error(i)}},refresh:function(){},get_element:function(){return this._element},clearBinding:function(n,t){for(var i=new f(this.bindings),r,u=[];i.next();)(r=i.current(),n&&r.element!=n)||t&&r.key!=t||(r.dispose(),u.push(r));for(i=new f(u);i.next();)d.remove(this.bindings,i.current())},addBinding:function(n,t,i,u,f,e,o,s){this.clearBinding(t,i);var h=new r.AtomBinding(n,t,i,u,f,e,o,s);this.bindings.push(h);h.setup()},get_errors:function(){return n.errors.get(this._element,!0)},get_atomParent:function(t){if(t==null)if(this._element._logicalParent||this._element.parentNode)t=this._element._logicalParent||this._element.parentNode;else return null;return t.atomControl?t.atomControl:t===o||t===n||!t.parentNode?null:this.get_atomParent(t._logicalParent||t.parentNode)},get_templateParent:function(n){if(n||(n=this._element),n._templateParent)return n._templateParent;var t=n._logicalParent||n.parentNode;if(!t)throw new Error("Could not find templateParent");return this.get_templateParent(n._logicalParent||n.parentNode)},get_data:function(){if(this._data===undefined){var n=this.get_atomParent(this._element._logicalParent||this._element.parentNode);if(n)return n.get_data()}return this._data},set_data:function(n){this._data=n;this.mergeData();this.updateChildBindings(this._element)},validate:function(){nt.validate(this._element)},mergeData:function(){this._mergeData2&&i.merge(this.get_data(),this._mergeData2,!0)},updateChildBindings:function(n){for(var r=new h(n),t,i;r.next();){if(t=r.current(),t.atomControl&&t.atomControl._created){if(i=t.atomControl,i._data!==undefined)continue;AtomBinder.refreshValue(i,"data");i.mergeData()}this.updateChildBindings(t)}},initProperties:function(){if(!this._disposed){var n=this.get_element();this.setProperties(n);this._created=!0;this.onCreated();this.onLoaded()}},createChildren:function(){var n,e,o,r,i;this.onCreateChildren(this._element);if(n=this.getTemplate("template"),n&&(e=new h(this._element),!e.next())){if(n.constructor==String)this._element.innerHTML=n,o=this,t(this._element).children().each(function(){this._templateParent=o});else if(u.isNode(n))n=u.cloneNode(n),n._templateParent=this,this._element.appendChild(n);else for(r=new f(n);r.next();)i=r.current(),i=u.cloneNode(i),i._templateParent=this,this._element.appendChild(i);this.onCreateChildren(this._element)}},onCreateChildren:function(n){for(var s=new h(n),t,i,r,f,e,c,o;s.next();){if(t=s.current(),i=u.attributeMap(t,/^atom\-(template|presenter|type|template\-name)$/gi),r=i["atom-template"],r){t.removeAttributeNode(r.node);n.templateOwner=!0;this["_"+r.value]=t;n.removeChild(t);continue}if(f=i["atom-template-name"],f){t.removeAttributeNode(f.node);this._scopeTemplates=this._scopeTemplates||{};this._scopeTemplates[f.value]=t;n.removeChild(t);continue}if(e=i["atom-presenter"],e&&(c=u.getPresenterOwner(this,e.value),c["_"+e.value]=t),o=i["atom-type"],o)u.createControl(t,o.value);else this.onCreateChildren(t)}},onLoaded:function(){},onUpdateUI:function(){this._layout?this._layout.doLayout(this._element):this.updateChildUI(this.get_element())},updateUI:function(){var n=this;this.dispatcher.callLater(function(){n.onUpdateUI()})},updateChildUI:function(n){var i,t;for(n||(n=this._element),i=new h(n);i.next();){if(t=i.current(),t.atomControl){t.atomControl.updateUI();continue}this.updateChildUI(t)}},onCreated:function(){this.updateUI()},setProperties:function(n){var i,o,u,b=n.attributes,e=new f(b),s=[],p="value",c,l,w,a,v;for(y.isIE&&y.majorVersion<9&&(p="nodeValue"),c={},l=null;e.next();){if(u=e.current(),i=u.nodeName,o=u[p],i==="data-atom-init"){l=o;s.push(u);continue}if(/^data\-atom/.test(i)&&(i=i.substr(5)),!/^atomControl$/g.test(i)){if(/^atom\-type$/.test(i)){s.push(u);continue}/^(atom|bind|style|event)\-/g.test(i)&&(/^(style|event)\-/g.test(i)||(i=i.substr(5)),o)&&(/(^style$|dock)/.test(i)||s.push(u),i=t.camelCase(i),c[i]=o)}}l&&(w=r.PageSetup[l],w.call(this,n));for(i in c)this.setValue(i,c[i],!0,n);for(e=new f(s);e.next();)n.removeAttributeNode(e.current());for(a=new h(n);a.next();)(v=a.current(),v.atomControl)||this.setProperties(v)},setValue:function(n,t,i,r){if(t&&t.constructor==String){var f=t[0],u=ft[f];if(u){u(this,n,t,r);return}if(f+=t[1],u=ft[f],u){u(this,n,t,r);return}}this.setLocalValue(n,t,r)},setLocalValue:function(n,t,i,r){var o,f,s,c,u,l,h;if(t!==undefined){if(t&&t instanceof e){i._promisesQueue=i._promisesQueue||{};o=i._promisesQueue[n];o&&o.abort();i._promisesQueue[n]=t;t._persist&&(this._promises=this._promises||{},this._promises[n]=t);f=this;t.then(function(t){i._promisesQueue[n]==t&&(i._promisesQueue[n]=null);i._promisesQueue[n]=null;f.setLocalValue(n,t.value(),i,!0);f._loadNext&&f.invokeAction(f._loadNext)});t.failed(function(t){i._promisesQueue[n]==t&&(i._promisesQueue[n]=null)});t.invoke();return}if(this._element==i&&(s=this["set_"+n],s!=null)){if(r&&(c=AtomBinder.getValue(this,n),c==t))return;s.apply(this,[t]);r&&AtomBinder.refreshValue(this,n);return}if(/^style/g.test(n)&&n.length>5){u=n.substr(5);u=String.fromCharCode(u.charCodeAt(0)).toLowerCase()+u.substr(1);i.style[u]=t;return}if(/^event/g.test(n)&&n.length>5){u=n.substr(5);u=String.fromCharCode(u.charCodeAt(0)).toLowerCase()+u.substr(1);l=this;this.unbindEvent(i,u);this.bindEvent(i,u,null,null,function(n){l.invokeAction(t,n)});return}h=p[n]||p.any;h&&h.call(this,i||this._element,t,n)}},bind:function(t,i,r,u,f,e){var s,c,o,h;if(r==null){this.clearBinding(t,i);return}s=this;r&&r.constructor==String&&/^window\./g.test(r)&&(s=n);c=this.get_element();o=c!=t;o||(h=this["get_"+i],(h==undefined||h==null)&&(o=!0));switch(i){case"value":/input/gi.test(t.nodeName)&&(o=!0);this.addBinding(s,t,"value",r,u,o,f,e);break;case"text":this.addBinding(s,t,"text",r,!1,!0,f,e);break;default:this.addBinding(s,t,i,r,u,o,f,e)}},onInitialized:function(){},init:function(){var c,f,i,e,l,o;s.init.apply(this,arguments);var t=this.get_element(),h=u.attributeMap(t,/^atom\-(name|local\-scope)$/gi),n=h["atom-name"];if(n?(t.removeAttributeNode(n.node),n=n.value):(c=t.id,/^\_\_waID/.test(c)||(n=t.id)),n){if(/^(app|window|owner|scope|localScope|parent)$/gi.test(n))throw new Error("Invalid Control Name '"+n+"'");i=this.get_scope();AtomBinder.setValue(i,n,this);this._name=n}if(ls=h["atom-local-scope"],ls&&(this._localScope=new g(this,this.get_scope(),atomApplication),this._scope=this._localScope,this._name&&(this._localScope[this._name]=this),t.removeAttributeNode(ls.node)),f=this._scopeTemplates,f){i=this.get_scope();for(e in f)l=f[e],AtomBinder.setValue(i,e,l)}o=this;r.dispatcher.callLater(function(){o.initProperties()});this.initChildren(this._element);r.dispatcher.callLater(function(){o.onInitialized()})},dispose:function(n){var i,r;if(n){i=n.atomControl;i?i.dispose():(this.clearBinding(n),this.disposeChildren(n));t(n).remove();return}n=this._element;this._disposed=!0;this.disposeChildren(n);this.clearBinding();this.bindings.length=0;r=n.atomValidator;r&&(r.dispose(),n.atomValidator=undefined);s.dispose.apply(this,arguments)},disposeChildren:function(n){for(var u=y.isIE&&y.majorVersion<9,r=new h(n),i;r.next();)i=r.current(),i.atomControl?(i.atomControl.dispose(),u?i.atomControl=undefined:delete i.atomControl):(this.clearBinding(i),this.unbindEvent(i),this.disposeChildren(i));try{n.innerHTML=""}catch(f){t(n).html("")}},get_innerTemplate:function(){return this._template},set_innerTemplate:function(n){if(this._template!==n||!this._created){if(!this._created){var t=this;r.dispatcher.callLater(function(){t.set_innerTemplate(n)});return}this._template=n;this.disposeChildren(this._element);this.createChildren();this.setProperties(this._element);this.initChildren(this._element);this.updateUI()}},initChildren:function(n){for(var u=new h(n),i,e,o=[],r;u.next();){if(i=u.current(),i.nodeName=="SCRIPT"){if(r=t.trim(i.innerHTML),/^\(\{/.test(r)&&/\}\)$/.test(r))try{r=new Function("return "+r+";")();this.set_scope(r)}catch(s){tt(JSON.stringify(s));alert(JSON.stringify(s))}o.push(i);continue}e=i.atomControl;e?e.init():this.initChildren(i)}for(u=new f(o);u.next();)n.removeChild(u.current())}}})}(r.AtomUIComponent.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomItemsControl",base:n,start:function(){this._selectedItems=[];this._selectedElements=[];this._selectedIndexSet=!1;this._onUIChanged=!1;this._itemsPresenter=null;this._itemsPanel=null;this._presenters=["itemsPresenter"];this._childItemType=r.AtomControl},properties:{allowSelectFirst:!1,allowMultipleSelection:!1,uiVirtualize:!1,defaultValue:null,autoScrollToSelection:!1,selectAll:undefined,labelPath:"label",valuePath:"value",sortPath:null,valueSeparator:null,postData:null,postUrl:null,confirm:!1,confirmMessage:null,filter:null,items:null,itemTemplate:null},methods:{get_postData:function(){return this._postData||this.get_selectedItem()},get_allValues:function(){if(this._valueSeparator&&this._valuePath){for(var n=[],r=this._valuePath,u=function(n){return n[r]},t=i.query(this.get_dataItems());t.next();)n.push(u(t.current()));return n.join(this._valueSeparator)}},get_value:function(){var n,t;return this._allowMultipleSelection?(n=this._selectedItems,n.length==0)?this._value!==undefined?this._value:null:(n=d.getValues(n,this._valuePath),this._valueSeparator&&(n=n.join(this._valueSeparator)),n):(t=this.get_selectedItem(),!t)?this._value!==undefined?this._value:null:(this._valuePath&&(t=t[this._valuePath]),t)},set_value:function(n){var i,r,t;if(this._value=n,n===undefined||n===null){AtomBinder.clear(this._selectedItems);return}for(i=this.get_dataItems(),this._allowMultipleSelection&&this._valueSeparator?(n.constructor!=String&&(n=""+n),n=d.split(n,this._valueSeparator)):n=[n],r=d.intersect(i,this._valuePath,n),this._selectedItems.length=0,t=new f(r);t.next();)this._selectedItems.push(t.current());AtomBinder.refreshItems(this._selectedItems)},set_sortPath:function(n){if(this._sortPath=n,n)this.onCollectionChangedInternal("refresh",-1,null)},set_selectAll:function(n){var t,i;if(n!==undefined&&n!==null){if(this._selectedItems.length=0,t=this.get_dataItems(),n&&t)for(i=new f(t);i.next();)this._selectedItems.push(i.current());this._selectAll=!0;AtomBinder.refreshItems(this._selectedItems)}},refresh:function(){this._promises&&this._promises.items&&this._promises.items.invoke()},set_defaultValue:function(n){this.get_value()||AtomBinder.setValue(this,"value",n)},invokePost:function(){var n,i,t;if(this._onUIChanged&&(!this._confirm||confirm(this._confirmMessage))){if(!this._postUrl){this.invokeAction(this._next);return}(n=this.get_postData(),n!==null&&n!==undefined)&&(n=AtomBinder.getClone(n),i=this,t=e.json(this._postUrl,null,{type:"POST",data:n}),t.then(function(){i.invokeNext()}),t.invoke())}},invokeNext:function(){this.invokeAction(this._next)},set_filter:function(n){if(n!=this._filter&&(this._filter=n,this._filteredItems=null,this.hasItems()))this.onCollectionChangedInternal("refresh",-1,null)},isSelected:function(n){for(var t=new f(this._selectedItems),i=null;t.next();)if(i=t.current(),i==n)return!0;return!1},get_dataItems:function(){var n=this._items,r,u,e,o,s;if(this.hasItems()){if(r=this._filter,r){if(u=[],typeof r=="object")u=i.query(n).where(r).toArray();else for(e=new f(n);e.next();)o=e.current(),r(o,e.currentIndex())&&u.push(o);this._filteredItems=u;n=u}return s=this._sortPath,s&&(n=n.sort(s)),n}return t(this._itemsPresenter).children()},getIndexOfDataItem:function(n){if(n==null)return-1;for(var i=this.get_dataItems(),t=new f(i);t.next();)if(t.current()==n)return t.currentIndex();return-1},getDataItemAtIndex:function(n){return n==-1?null:this.get_dataItems()[n]},get_childAtomControls:function(){for(var r=this._itemsPresenter||this._element,t=[],i=new h(r),n;i.next();)(n=i.current(),n=!n||n.atomControl,n)&&t.push(n);return t},get_selectedChild:function(){var i=this.get_selectedItem(),n,t;if(!this.hasItems())return i;for(n=new h(this._itemsPresenter);n.next();)if(t=n.current(),t.atomControl.get_data()==i)return t;return null},set_allowSelectFirst:function(n){n=n?n!="false":n;this._allowSelectFirst=n},get_selectedItem:function(){return this._selectedItems.length>0?this._selectedItems[0]:null},set_selectedItem:function(n){n?(this._selectedItems.length=1,this._selectedItems[0]=n):this._selectedItems.length=0;AtomBinder.refreshItems(this._selectedItems)},get_selectedItems:function(){return this._selectedItems},set_selectedItems:function(){throw new Error("Not yet implemented");},get_selectedIndex:function(){var n=this.get_selectedItem();return this.getIndexOfDataItem(n)},set_selectedIndex:function(n){AtomBinder.setValue(this,"selectedItem",this.getDataItemAtIndex(n))},updateChildSelections:function(){},bringSelectionIntoView:function(){var t,n,i;if(!this._allowSelectFirst||this.get_selectedIndex()!=0)for(t=new h(this._itemsPresenter);t.next();)if(n=t.current(),i=n.atomControl?n.atomControl.get_data():n,this.isSelected(i)){n.scrollIntoView();return}},updateSelectionBindings:function(){AtomBinder.refreshValue(this,"value");AtomBinder.refreshValue(this,"selectedItem");AtomBinder.refreshValue(this,"selectedItems");AtomBinder.refreshValue(this,"selectedIndex");this._selectedItems.length||this._selectAll===!0&&(this._selectAll=!1,AtomBinder.refreshValue(this,"selectAll"))},onSelectedItemsChanged:function(n,t,i){this._onUIChanged||(this.updateChildSelections(n,t,i),this._autoScrollToSelection&&this.bringSelectionIntoView());this.updateSelectionBindings();this.updateUI();this.invokePost()},hasItems:function(){return this._items!=undefined&&this._items!=null},get_items:function(){return this._items},set_items:function(n){var t=this;if(this._items&&this.unbindEvent(this._items,"CollectionChanged",null),this._items=n,this._filteredItems=null,n!=null){this.bindEvent(this._items,"CollectionChanged",function(){t.onCollectionChangedInternal.apply(t,arguments)});this.onCollectionChangedInternal("refresh",-1,null)}},set_itemTemplate:function(n){this._itemTemplate=n;this.onCollectionChangedInternal("refresh",-1,null)},onCollectionChangedInternal:function(n,t,r){if(this._created){i.refresh(this,"allValues");var u=this.get_value();if(this.hasItems()){this.onCollectionChanged(n,t,r);u||this._allowSelectFirst||AtomBinder.clear(this._selectedItems)}if(u!=null){if(this.set_value(u),this.get_selectedIndex()!=-1)return;this._value=undefined}this.selectDefault()}},selectDefault:function(){if(this._allowSelectFirst&&this.get_dataItems().length>0){this.set_selectedIndex(0);return}this.updateSelectionBindings()},onScroll:function(){this.scrollTimeout&&clearTimeout(this.scrollTimeout);var n=this;this.scrollTimeout=setTimeout(function(){n.scrollTimeout=0;n.onVirtualCollectionChanged()},10)},onVirtualCollectionChanged:function(){var w=this._itemsPresenter,d=this.get_dataItems(!0),at=this.get_scope(),y=this.getTemplate("itemTemplate"),n,b,g,s,h,l,vt,ft,a,k,rt,p,lt,ut;if(y&&(y=u.getAtomType(y),y&&(this._childItemType=y)),n=new f(d),r.dispatcher.pause(),this._itemsPresenter==this._element&&(b=o.createElement("DIV"),g=t(b),g.addClass("atom-virtual-container"),g.css({posiiton:"absolute",width:"100%",height:"100%"}),this._element.innerHTML="",this._element.appendChild(b),this._itemsPresenter=b,w=this._itemsPresenter),s=this._cachedItems,s||(s={},this.disposeChildren(w)),this._cachedItems=s,!d.length){r.dispatcher.start();AtomBinder.refreshValue(this,"childAtomControls");return}h=this._itemsPresenter.parentElement;l=t(h);l.css("overflow","auto");t(w).css("position","relative");vt=l.width();ft=l.height();this.unbindEvent(h,"scroll");var et=d.length,ot=t(this._itemsPresenter).innerWidth(),yt=this.getTemplate("itemTemplate"),st=t(yt),c=st.outerHeight(!0),i=st.outerWidth(!0);if(!(c||i))throw new Error("Either width or height must be explicitly specified for virtualization");if(a=1,k=1,c>0)if(i>0)ot<=0&&console&&console.warn("presenterWidth is 0, you may need to stretch width",this),a=Math.ceil(ot/i)||1,k=Math.ceil(et/a)||1,l.css("overflow-x","hidden");else{if(!ft)throw new Error("Height must be explicitly specified for wrapping container");k=et;l.css("overflow-y","auto");l.css("overflow-x","hidden")}c>0?t(this._itemsPresenter).height(k*c):t(this._itemsPresenter).width(a*i);for(var ht=Math.floor(h.scrollLeft/(i||1)),ct=Math.floor(h.scrollTop/(c||1)),pt=Math.floor(h.offsetWidth/(i||1))-1||1,wt=h.offsetHeight/(c||1),nt=[];n.next();){var v=n.currentIndex(),tt=Math.floor(v/a),it=v%a,e=s[v];if(it<ht||it>ht+pt){e&&(s[v]=null,nt.push(e));continue}if(tt<ct||tt>ct+wt){e&&(s[v]=null,nt.push(e));continue}e||(rt=n.current(),e=this.createChildElement(at,w,rt,n),s[v]=e,p=t(e),p.css("position","absolute"),i>0&&(p.css("width",i+"px"),p.css("left",it*i+"px")),c>0&&p.css("top",tt*c+"px"),this.applyItemStyle(e,rt,n.isFirst(),n.isLast()))}for(lt=this,this.bindEvent(h,"scroll",function(){lt.onScroll()}),r.dispatcher.start(),n=new f(nt);n.next();)ut=n.current(),ut.atomControl.dispose(),t(ut).remove();AtomBinder.refreshValue(this,"childAtomControls")},onCollectionChanged:function(n,i,e){var a,l,o,c,s,v,y,k,p,w,g;if(/reset|refresh/i.test(n)&&(this._scopes={},this._cachedItems=null),this._uiVirtualize){this.onVirtualCollectionChanged();return}if(/remove/gi.test(n)){for(c=new h(this._itemsPresenter);c.next();)if(s=c.current(),s.atomControl&&s.atomControl.get_data()==e){s.atomControl.dispose();t(s).remove();break}this.updateUI();return}if(a=this.get_scope(),l=this.getTemplate("itemTemplate"),l&&(l=u.getAtomType(l),l&&(this._childItemType=l)),/add/gi.test(n)){for(r.dispatcher.pause(),o=new f(this._items),c=new h(this._itemsPresenter);o.next();){if(c.next(),s=c.current(),o.currentIndex()==i){v=this.createChildElement(a,this._itemsPresenter,e,o,s);this.applyItemStyle(v,e,o.isFirst(),o.isLast());break}if(o.isLast()){v=this.createChildElement(a,this._itemsPresenter,e,o);this.applyItemStyle(v,e,o.isFirst(),o.isLast());break}}r.dispatcher.start();this.updateUI();return}y=this._itemsPresenter;k=this.get_dataItems();this.disposeChildren(y);r.dispatcher.pause();var d=this.get_dataItems(!0),b=[],o=new f(d);for(this.getTemplate("itemTemplate");o.next();)p=o.current(),w=this.createChildElement(a,y,p,o),b.push(w),this.applyItemStyle(w,p,o.isFirst(),o.isLast());g=this;r.dispatcher.callLater(function(){for(var r=[],i=new h(y),u,n;i.next();)n=i.current(),u=b.filter(function(t){return n==t}),u.pop()!=n&&r.push(n);for(i=new f(r);i.next();)n=i.current(),n.atomControl&&n.atomControl.dispose(),t(n).remove()});r.dispatcher.start();AtomBinder.refreshValue(this,"childAtomControls")},set_innerTemplate:function(){this._itemsPresenter=this._element;n.set_innerTemplate.apply(this,arguments);this.onCollectionChangedInternal("mode",-1,null)},applyItemStyle:function(){},createChildElement:function(n,t,i,f,e){var s=u.cloneNode(this._itemTemplate),h,o,c;return s._logicalParent=t,s._templateParent=this,s._isDirty=!0,r.dispatcher.callLater(function(){e?t.insertBefore(s,e):t.appendChild(s)}),h=this._scopes||{},this._scopes=h,o=h[f.currentIndex()]||new g(this,n,n.__application),h[f.currentIndex()]=o,f&&(o.itemIsFirst=f.isFirst(),o.itemIsLast=f.isLast(),o.itemIndex=f.currentIndex(),o.itemExpanded=!1,o.data=i,o.get_itemSelected=function(){return o.owner.isSelected(i)},o.set_itemSelected=function(){o.owner.toggleSelection(i,!0)}),c=u.createControl(s,this._childItemType,i,o),s},toggleSelection:function(n){this._onUIChanged=!0;this._value=undefined;this._allowMultipleSelection?u.contains(this._selectedItems,n)?AtomBinder.removeItem(this._selectedItems,n):AtomBinder.addItem(this._selectedItems,n):(this._selectedItems.length=1,this._selectedItems[0]=n,AtomBinder.refreshItems(this._selectedItems));this._onUIChanged=!1},onUpdateUI:function(){var t,i,r;for(n.onUpdateUI.call(this),this._uiVirtualize&&this.onVirtualCollectionChanged(),t=new h(this._itemsPresenter);t.next();)(i=t.current(),i.atomControl)&&(r=i.atomControl.get_data(),AtomBinder.refreshValue(i.atomControl.get_scope(),"itemSelected"),this.applyItemStyle(i,r,t.isFirst(),t.isLast()))},onCreated:function(){if(this._items)this.onCollectionChangedInternal("refresh",-1,null);var n=this;this.dispatcher.callLater(function(){n._autoScrollToSelection&&n.bringSelectionIntoView()})},dispose:function(){n.dispose.call(this);this._selectedItems=null;this._scopes=null;this._cachedItems=null},init:function(){var r=this.get_element(),i,t;this._itemsPresenter||(this._itemsPresenter=this._element);i=this;this.bindEvent(this._selectedItems,"CollectionChanged",function(){i.onSelectedItemsChanged.apply(i,arguments)});n.init.apply(this,arguments);t=this;this.removeItemCommand=function(n,i){if(i){var r=i.get_data();AtomBinder.removeItem(t._items,r)}};this.removeSelectedCommand=function(){for(var i=t.get_selectedItems().slice(0),n=new f(i);n.next();)AtomBinder.removeItem(t.get_items(),n.current())};this.removeAllCommand=function(){AtomBinder.clear(t.get_items())}}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomButton",base:n,start:function(n){this._sendData=!1;t(n).addClass("atom-button")},properties:{sendData:!1},methods:{onClickHandler:function(n){return u.cancelEvent(n),this._next&&(this._sendData&&this._next&&AtomBinder.setValue(this._next,"data",this.get_data()),this.invokeAction(this._next)),!1},init:function(){var t=this._element;this.bindEvent(t,"click","onClickHandler");n.init.apply(this)}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomListBox",base:n,start:function(){this._labelPath="label";this._valuePath="value";this._autoScrollToSelection=!1},properties:{autoSelectOnClick:!0},methods:{setClass:function(){var n=t(this._element);n.addClass("atom-list-box")},onClick:function(n){if(this._autoSelectOnClick)this.onSelectItem(null,null,n)},get_itemWidth:function(){if(!this._items||!this._items.length)return 0;var n=t(this._element).innerWidth();return n/this._items.length},applyItemStyle:function(n,i,r,u){var f=t(n);(f.removeClass("selected-item list-item first-item last-item"),i)&&(f.addClass("list-item"),r&&f.addClass("first-item"),u&&f.addClass("last-item"),this.isSelected(i)&&f.addClass("selected-item"))},onCreated:function(){this.bindEvent(this._itemsPresenter,"click","onClick");n.onCreated.call(this)},invokePost:function(){this.get_selectedIndex()!=-1&&n.invokePost.apply(this,arguments)},onSelectItem:function(n,t,i){for(var e=i?i.target:null,s=this._itemsPresenter,r=e||t._element,h=/checkbox/i.test(r.type),u,f;r.parentNode!=null&&r.parentNode!=s;)r=r.parentNode;if(r!=o)if(u=r,this.hasItems()&&(u=r.atomControl.get_data()),h){f=this._allowMultipleSelection;try{this._allowMultipleSelection=!0;this.toggleSelection(u)}finally{this._allowMultipleSelection=f}}else this.toggleSelection(u)},updateChildSelections:function(){var t=this._element,i;/select/i.test(t.tagName)?(i=this.get_selectedIndex(),t.selectedIndex!=i&&r.dispatcher.callLater(function(){t.selectedIndex=i})):n.updateChildSelections.apply(this,arguments)},init:function(){this.setClass();n.init.call(this);var t=this,i=this._element;/select/i.test(i.tagName)&&(this.set_allowSelectFirst(!0),this.bindEvent(i,"change",function(){AtomBinder.setValue(t,"selectedIndex",i.selectedIndex)}));this.selectCommand=function(){t.onSelectItem.apply(t,arguments)};this.selectAllCommand=function(){t.set_selectAll(!0)};this.clearSelectionCommand=function(){t.set_selectedIndex(-1)}}}})}(r.AtomItemsControl.prototype),function(i){return classCreatorEx({name:"WebAtoms.AtomAutoCompleteBox",base:i,start:function(n){t(n).addClass("atom-auto-complete-box");this._presenters=["itemsPresenter","inputBox","selectionBox"];this._mouseCapture=0},properties:{isPopupOpen:!1,autoOpen:!1,selectedText:"",placeholder:undefined,keyPressed:undefined,displayLabel:undefined},methods:{get_offsetLeft:function(){return t(this._element).offset().left},get_offsetTop:function(){return t(this._element).offset().top},get_offsetWidth:function(){return t(this._inputBox).offset().width},set_itemsUrl:function(n){var t="[ !$owner.keyPressed ? undefined : AtomPromise.json('"+n+"').showProgress(false) ]";this.setValue("items",t,!0,this._element)},set_isPopupOpen:function(t){if(this._isPopupOpen=t,t){AtomBinder.refreshValue(this,"offsetTop");AtomBinder.refreshValue(this,"offsetLeft");AtomBinder.refreshValue(this,"offsetWidth");var i=this;this.trySelect();this.bindEvent(n,"click",function(){i.onWindowClick.apply(i,arguments)})}else this.unbindEvent(n,"click")},onSelectedItemsChanged:function(){this._onUIChanged&&this._selectedItems.length>0&&this.refreshLabel();i.onSelectedItemsChanged.apply(this,arguments)},onClick:function(){i.onClick.apply(this,arguments);this._backupValue=this.get_value();this.refreshLabel();this._backupLabel=this.get_displayLabel();AtomBinder.setValue(this,"keyPressed",!1);AtomBinder.setValue(this,"isPopupOpen",!1)},restoreSelection:function(){AtomBinder.setValue(this,"isPopupOpen",!1);this._backupValue?(AtomBinder.setValue(this,"value",this._backupValue),AtomBinder.setValue(this,"displayLabel",this._backupLabel),this._backupValue=null):AtomBinder.setValue(this,"selectedIndex",-1)},onKeyUp:function(n){var t,i;AtomBinder.setValue(this,"isPopupOpen",!0);switch(n.keyCode){case 27:AtomBinder.setValue(this,"keyPressed",!1);this.restoreSelection();return;case 13:return AtomBinder.setValue(this,"keyPressed",!1),AtomBinder.setValue(this,"isPopupOpen",!1),this._backupValue=this.get_value(),this.refreshLabel(),this._backupLabel=this.get_displayLabel(),u.cancelEvent(n);case 37:break;case 38:AtomBinder.setValue(this,"keyPressed",!1);this.moveSelection(!0);return;case 39:break;case 40:AtomBinder.setValue(this,"keyPressed",!1);this.moveSelection(!1);return;default:t=this;this.dispatcher.callLater(function(){t.trySelect()})}this.oldTimeout&&clearTimeout(this.oldTimeout);i=this;this.oldTimeout=setTimeout(function(){AtomBinder.setValue(i,"keyPressed",!0)},500)},trySelect:function(){var i,n;if(this._items&&this._items.length!=0){var r=new f(this._items),u=this._labelPath,t=this._displayLabel;for(t&&(t=t.toLowerCase());r.next();)if(i=r.current(),n=i,u&&(n=n[u]),n.toLowerCase().indexOf(t)==0){AtomBinder.setValue(this,"selectedItem",i);AtomBinder.setValue(this,"selectedText",n);this.bringSelectionIntoView();return}}},moveSelection:function(n){if(this._items&&this._items.length){var t=this.get_selectedIndex();t==-1&&(this.backupLabel=this.get_displayLabel());t=n?t-1:t+1;n&&t==-2&&(t=this._items.length-1);n||t!=this._items.length||(t=-1);AtomBinder.setValue(this,"selectedIndex",t);t==-1?AtomBinder.setValue(this,"displayLabel",this.backupLabel||""):this.refreshLabel()}},refreshLabel:function(){var t=this.get_selectedItem(),n=t;n&&this._labelPath&&(n=n[this._labelPath]);AtomBinder.setValue(this,"displayLabel",n||"")},onWindowClick:function(n){for(var i=this._element,r=this._itemsPresenter,t=n.target;t.parentNode!=null&&t!=i&&t!=r;)t=t.parentNode;t!=i&&t!=r&&this.restoreSelection()},onInputFocus:function(){this._autoOpen&&(this._backupValue=this.get_value(),this._backupLabel=this.get_displayLabel(),AtomBinder.setValue(this,"isPopupOpen",!0),t(this._inputBox).select())},onInputBlur:function(){if(!this._mouseCapture){var n=this;setTimeout(function(){n._isPopupOpen&&(AtomBinder.setValue(n,"isPopupOpen",!1),n.restoreSelection())},10)}},onCreated:function(){this._itemsPresenter._logicalParent=this._element;t(this._itemsPresenter).remove();o.body.appendChild(this._itemsPresenter);t(this._itemsPresenter).addClass("auto-complete-popup");i.onCreated.apply(this,arguments);this.bindEvent(this._itemsPresenter,"mouseover","onMouseOver");this.bindEvent(this._itemsPresenter,"mouseout","onMouseOut")},onMouseOver:function(){this._mouseCapture++},onMouseOut:function(){var n=this;setTimeout(function(){n._mouseCapture--},1e3)},init:function(){i.init.apply(this,arguments);this.bindEvent(this._inputBox,"focus","onInputFocus");this.bindEvent(this._inputBox,"blur","onInputBlur");this.bindEvent(this._inputBox,"keyup","onKeyUp")},dispose:function(){this._itemsPresenter&&(this.disposeChildren(this._itemsPresenter),t(this._itemsPresenter).remove(),this._itemsPresenter=null);i.dispose.call(this)}}})}(r.AtomListBox.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomComboBox",base:n,start:function(){this._labelPath="label";this._valuePath="value";this._allowSelectFirst=!0},methods:{invokePost:function(){this.get_selectedIndex()>0&&n.invokePost.apply(this,arguments)},invokeNext:function(){n.invokeNext.apply(this,arguments);this._postUrl&&(AtomBinder.setValue(this,"selectedIndex",0),this.updateChildSelections())},onSelectionChanged:function(){this._onUIChanged=!0;var n=this.get_element();this.set_selectedIndex(n.selectedIndex);this._onUIChanged=!1},updateChildSelections:function(){var n=this._element;n.selectedIndex=this.get_selectedIndex()},onCollectionChanged:function(){var u=this.get_element(),e=this.get_dataItems(),r;u.options.length=e.length;for(var i=new f(e),o=this._labelPath,s=this._valuePath,t=null,n=null,h=this.get_value();i.next();)r=i.current(),t=r,n=r,o&&(t=t[o]),s&&(n=n[s]),u.options[i.currentIndex()]=new Option(t,n,!1,n==h)},verifyTemplates:function(){},init:function(){var t=this.get_element();this.bindEvent(t,"change","onSelectionChanged");n.init.apply(this,arguments)}}})}(r.AtomItemsControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDateListBox",base:n,start:function(){this._monthList=s.monthList;var n=new Date;this._month=n.getMonth()+1;this._year=n.getFullYear();this._selectedItems=[];this._presenters=["itemsPresenter"];this._startYear=-5;this._endYear=10;this._currentYear=(new Date).getFullYear();this._value=null},properties:{month:0,year:0,selectedItems:[],startYear:-5,endYear:0,currentYear:0,monthList:null,items:undefined,month:null,visibleDate:undefined},methods:{set_month:function(n){this._month=n;this.updateList()},set_year:function(n){this._year=n;this.updateList()},set_visibleDate:function(n){n&&(this._visibleDate=n,this._year=n.getFullYear(),this._month=n.getMonth()+1,this.updateList(),AtomBinder.refreshValue(this,"year"),AtomBinder.refreshValue(this,"month"))},init:function(){n.init.apply(this);var t=this;this.toggleDateCommand=function(){t.toggleDate.apply(t,arguments)}},onLoaded:function(){var o=this.getTemplate("itemTemplate"),h=this.get_scope(),c=this._itemsPresenter,n=this.getTemplate("itemTemplate"),s,i,f,e,l;if(n&&(n=u.getAtomType(n),n||(n=r.AtomControl)),this.updateList(),o)for(s=this._items,i=0;i<42;i++)f=u.cloneNode(o),f._templateParent=this,e=new g(this,h,atomApplication),e.itemIndex=i,t(c).append(f),l=u.createControl(f,n,s[i],e)},toggleDate:function(n,i){var r=i.get_data(),u=t.inArray(r.value,t.map(this._selectedItems,function(n){return n.value}));u>-1?AtomBinder.removeAtIndex(this._selectedItems,u):AtomBinder.addItem(this._selectedItems,r);AtomBinder.refreshValue(this,"value");AtomBinder.refreshValue(this,"selectedItems");this.invokeAction(this._next)},getItemClass:function(n){var u=t.inArray(n.value,t.map(this._selectedItems,function(n){return n.value}))>-1,r=n.date.getDay(),f=r==0||r==6,i="atom-date-list-box-day-list-item ";return i+=f?"atom-date-list-box-weekend ":"",i+=u?"atom-date-list-box-selected ":"atom-date-list-box-item ",i+(this._month==n.date.getMonth()+1?"":"atom-date-list-box-day-list-item-other")},set_value:function(n){var f,t,i,r,u;if(n!==undefined){if(this._selectedItems.length=0,n!==null)for(f=n.split(","),t=0;t<f.length;t++)(i=f[t],i)&&(r=i.split("/"),u=new Date(parseInt(r[2],10),parseInt(r[0],10)-1,parseInt(r[1],10)),this._selectedItems.push({date:u,dateLabel:s.toShortDateString(u),value:i,label:u.getDate()}));this._created&&(AtomBinder.refreshItems(this._selectedItems),AtomBinder.refreshValue(this,"value"),AtomBinder.refreshValue(this,"selectedItems"))}},get_value:function(){return t.map(this._selectedItems,function(n){return n.value}).join(",")},updateList:function(){var i;if(this._month&&this._year){var f=new Date,a=new Date(this._year,this._month-1,1),t=new Date(this._year,this._month-1,1);t.getDay()&&(i=t.getDay()-1,i=-i,t.setDate(i));for(var o=t.getMonth(),h=t.getFullYear(),e=[],r=0,c=this._month-1,r=0;r<42;r++){var l=r+t.getDate(),n=new Date(h,o,l),u=n.getDay();u=u==0||u==6;e.push({label:n.getDate(),isWeekEnd:u,isToday:f.getDate()==n.getDate()&&f.getMonth()==n.getMonth()&&f.getFullYear()==n.getFullYear(),isOtherMonth:n.getMonth()!=c,dateLabel:s.toShortDateString(n),value:s.toMMDDYY(n),date:n})}this._items=e;AtomBinder.refreshValue(this,"items");AtomBinder.refreshValue(this,"selectedItems");this._created&&AtomBinder.refreshValue(this,"value")}}}})}(r.AtomControl.prototype),function(i){var r=n.AtomUI;return classCreatorEx({name:"WebAtoms.AtomDockPanel",base:i,start:function(n){t(n).addClass("atom-dock-panel")},properties:{resizeOnChildResized:!1,contentWidth:0},methods:{resizeChild:function(n){n.atomControl?n.atomControl.updateUI():this.updateChildUI(n)},calculateSize:function(){var o=this.get_element(),f=t(o),n={width:f.width(),height:f.height()},i,e,u,s,c;if(!this._resizeOnChildResized)return n;for(i=0,e=new h(o);e.next();){u=e.current();s=r.attr(u,"atom-dock");switch(s){case"Bottom":case"Fill":case"Top":c=y.isIE&&y.majorVersion<10?u.offsetHeight:t(u).outerHeight(!0);i+=c}}return n.height<i&&(n.height=i,f.height(n.height)),n},onUpdateUI:function(){var w=this.get_element(),g=t(w),a=0,v=parseInt(t(w).css("paddingTop"),10),k=this.calculateSize(),y=k.height,s=k.width,d,i,n,p,o,b,c,l,e,u;for(this._contentWidth&&(a=(s-this._contentWidth)/2,s=this._contentWidth),d=[],o={top:[],bottom:[],left:[],right:[],fill:[]},isScriptOrStyle=/script|style/i,b=new h(w);b.next();)if((c=b.current(),!isScriptOrStyle.test(c.tagName))&&(l=t(c),l.css("display")!="none")&&l.css("visibility")!="hidden"){if(l.is(".dock-left,[dock$='Left']")){o.left.push(c);continue}if(l.is(".dock-right,[dock$='Right']")){o.right.push(c);continue}if(l.is("header,.dock-top,[dock$='Top']")){o.top.push(c);continue}if(l.is("footer,.dock-bottom,[dock$='Bottom']")){o.bottom.push(c);continue}if(l.is("section,.dock-fill,[dock$='Fill']")){o.fill.push(c);continue}}for(i=new f(o.top);i.next();)n=i.current(),u=t(n),p=u.outerHeight(!0),r.setItemRect(u,n,{top:v,left:a,width:s}),v+=p,y-=p,this.resizeChild(n);for(i=new f(o.bottom.reverse());i.next();)n=i.current(),u=t(n),p=u.outerHeight(!0),y-=p,r.setItemRect(u,n,{left:a,top:v+y,width:s}),this.resizeChild(n);for(i=new f(o.left);i.next();)n=i.current(),u=t(n),e=u.outerWidth(!0),s-=e,r.setItemRect(u,n,{top:v,left:a,height:y}),a+=e,this.resizeChild(n);for(i=new f(o.right.reverse());i.next();)n=i.current(),u=t(n),e=u.outerWidth(!0),s-=e,r.setItemRect(u,n,{left:s+a,top:v,height:y}),this.resizeChild(n);for(i=new f(o.fill);i.next();)n=i.current(),u=t(n),e=u.css("max-width"),e&&(e=parseFloat(e),e>0&&(s=e)),r.setItemRect(u,n,{left:a,top:v,width:s,height:y}),this.resizeChild(n)}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomPostButton",base:n,start:function(){},properties:{postData:null,postResult:null,postUrl:null,next:null,confirm:!1,confirmMessage:null,mergeData:null},methods:{get_postData:function(){return this._postData||this.get_data()},onClickHandler:function(n){if(this._confirm){var t=this;i.confirm(this._confirmMessage,function(){t.onConfirmed(n)});return}this.onConfirmed(n)},onConfirmed:function(){var t,i,u,r,f;if(!this._postUrl){n.onClickHandler.apply(this,arguments);return}if(t=this.get_postData(),t!==null&&t!==undefined){if(i=this._mergeData,i)for(u in i)t[u]=i[u];r=this;f=function(n){AtomBinder.setValue(r,"postResult",n.value());r.invokeAction(r._next)};e.json(this._postUrl,null,{type:"POST",data:t}).then(f).invoke()}}}})}(r.AtomButton.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomToggleButtonBar",base:n,start:function(){this._allowSelectFirst=!0;this._allowMultipleSelection=!1;this._showTabs=!1;this._autoScrollToSelection=!1},properties:{showTabs:!1},methods:{setClass:function(){var n=t(this._element);n.removeClass("atom-tab-bar atom-toggle-button-bar");n.addClass(this._showTabs?"atom-tab-bar":"atom-toggle-button-bar")},set_showTabs:function(n){this._showTabs=n;this.setClass()}}})}(r.AtomListBox.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomViewStack",base:n,start:function(){this._swipeDirection="left-right"},properties:{selectedIndex:-1,previousIndex:-1,swipeDirection:"left-right"},methods:{bringSelectionIntoView:function(){},set_swipeDirection:function(n){var i=this._swipeDirection;i&&t(this._element).removeClass(i);this._swipeDirection=n;n&&t(this._element).addClass(n)},set_selectedIndex:function(n){if(this._isAnimating){var t=this;setTimeout(function(){t.set_selectedIndex(n)},50);return}n!=this._selectedIndex&&(this._previousIndex=this._selectedIndex,this._selectedIndex=n,this.updateUI())},get_selectedChild:function(){return this._selectedChild},onUpdateUI:function(){var y=this._element,b=new h(y),p=this.get_selectedIndex(),s=this._previousIndex,k=r.dispatcher,e,d,n,o,c,l,f,g,i,w,v;for(k.pause(),e=-1,d=this;b.next();)e=e+1,c=b.current(),l=t(c),l.addClass("view-stack-child"),s==-1&&l.addClass("hidden"),e==p?n=c:e==s?o=c:l.addClass("hidden");if(n)if(f=t(y).innerWidth(),g=t(y).innerHeight(),this._selectedChild=n,i=t(n),u.setItemRect(i,n,{width:f,height:g}),w=n.atomControl,w&&w.updateUI(),o&&o!=n){var d=this,a=t(o),nt=this._swipeDirection;nt!=null&&/none/i.test(nt)?(a.addClass("hidden"),i.removeClass("hidden")):(v=[n,o],t(v).removeClass("hidden"),this._isAnimating=!0,p<s?i.css("left",-f):i.css("left",f),t(v).addClass("animate-left-property"),setTimeout(function(){i.css("left",0);p<s?a.css("left",f):a.css("left",-f);setTimeout(function(){d._isAnimating=!1;t(v).removeClass("animate-left-property");a.addClass("hidden")},800)},50))}else i.removeClass("hidden");k.start()},init:function(){var r=this.get_element(),i=t(r);i.addClass("atom-view-stack");n.init.call(this);r.parentNode.atomControl||i.addClass("atom-view-stack-fill");i.addClass(this._swipeDirection)}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomForm",base:n,start:function(){this._success=null;this._submit=null;this._errors=null;this._attachments=null},properties:{result:null,mergeData:null,mergeResult:!0,postUrl:null,postData:null,successMessage:null,clearData:!1,errorTemplate:null},methods:{createFormLayout:function(){},preparePostData:function(){var r=this.get_element(),i=this._postData||this.get_data(),n=this._mergeData,t;if(n)for(t in n)i[t]=n[t];return i},onSubmit:function(){var n,r,u,f;if(this.validate(),n=this.get_errors(),n.length){r=o.getElementsByTagName("label");this.invokeAction({localWindow:{path:this.getTemplate("errorTemplate"),prop:{data:n.map(function(n){var u=i.query(r).firstOrDefault({control:n.value});return u&&(n.label=t(u).text()+" ("+n.label+")"),n}),title:"Form Errors"}}});return}u=this.preparePostData();f=e.getUrl(this._postUrl);e.json(f,{_tv:i.time()},{type:"POST",data:u}).then(this._success).invoke()},onSuccess:function(n){var r=n.value(),u,t;if(AtomBinder.setValue(this,"result",r),this._mergeResult){u=this.get_data();for(t in r)AtomBinder.setValue(u,t,r[t])}if(this._clearData){u=this.get_data();for(t in this._clearData)AtomBinder.setValue(u,t,r[t])}this._successMessage&&i.alert(this._successMessage);this.invokeAction(this._next)},onKeyUp:function(n){if((!n.target||!n.target.nodeName||!/textarea/gi.test(n.target.nodeName))&&n.keyCode==13){var i=this;/input/gi.test(n.target.nodeName)&&t(n.target).change();r.dispatcher.callLater(function(){i.onSubmit()})}},init:function(){var i,u;n.init.call(this);i=this;this._success=function(){i.onSuccess.apply(i,arguments)};this._submit=function(){r.dispatcher.callLater(function(){i.onSubmit.apply(i,arguments)})};u=this.get_element();this.submitCommand=this._submit;/form/i.test(this._element.nodeName)?this.bindEvent(u,"submit",function(n){return n&&n.preventDefault(),i.submitCommand(),!1}):(this.bindEvent(u,"keyup","onKeyUp"),t(u).find("input[type=submit]").bind("click",null,this._submit),t(u).find("button[type=submit]").bind("click",null,this._submit))}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormLayout",base:n,start:function(){this._useTable=!0;this._errorItems=[];this._minLabelWidth=0},properties:{minLabelWidth:0},methods:{createField:function(n,t){var l=!1,f=u.attributeMap(t,/^(atom\-(init|type|label|field\-(visible|class)))$/i),s=f["atom-type"],i,e,c,a,o,v;if(s){f["atom-type"]=null;switch(s.value){case"AtomFormField":l=!0;break;case"AtomFormGridLayout":case"AtomFormTab":return n.appendChild(t),u.createControl(t,s.value)}}if(i=u.cloneNode(this._fieldTemplate),e=u.findPresenter(i),e){if(l)for(c=new h(t);c.next();)e.appendChild(c.current());else e.appendChild(t);u.removeAttr(e,"atom-presenter")}else i.contentElement=t;n.appendChild(i);for(a in f)(o=f[a],o)&&(t.removeAttributeNode(o.node),i.setAttributeNode(o.node));return f=u.attributeMap(t,/^atom\-required$/i),v=u.assignID(t),u.attr(i,"atom-field-id",v),f["atom-required"]&&u.attr(i,"atom-required","true"),u.createControl(i,r.AtomFieldType)},createChildren:function(){var n=this._element,r,i,e,s;for(t(n).addClass("atom-form"),r=new f(t(n).children()),i=o.createElement("TABLE"),t(i).addClass("atom-form-table"),e=o.createElement("TBODY"),u.removeAllChildren(n),n.appendChild(i),i.appendChild(e),this.getTemplate("fieldTemplate");r.next();)(s=r.current(),s)&&this.createField(e,s)}}})}(r.AtomControl.prototype),function(){return classCreatorEx({name:"WebAtoms.AtomLayout",start:function(){},methods:{doLayout:function(){}}})}(),function(n){return classCreatorEx({name:"WebAtoms.AtomWindow",base:n,start:function(){this._presenters=["windowDiv","windowTitleDiv","windowCloseButton","iframe","windowPlaceholder"]},properties:{opener:null,openerData:null,windowTemplate:null,isOpen:!1,windowHeight:300,windowWidth:500,url:undefined,title:undefined,windowUrl:undefined,cancelNext:undefined},methods:{get_openerData:function(){var n=this.get_opener();if(n)return n.get_data()},onCloseCommand:function(){AtomBinder.setValue(this,"isOpen",!1);var t=this._value,n=this;this._value=null;r.dispatcher.callLater(function(){AtomBinder.setValue(n,"value",t);n.invokeAction(n._next);n.disposeChildren(n._element)})},onCancelCommand:function(){AtomBinder.setValue(this,"isOpen",!1);var n=this;r.dispatcher.callLater(function(){n.invokeAction(n._cancelNext);n.disposeChildren(n._element)})},refresh:function(n,t){this.openWindow(n,t)},openWindow:function(n,i){var o=this.getTemplate("frameTemplate"),s,e,h;o=u.cloneNode(o);var l=t(o),c=l.find("[data-atom-presenter=windowDiv],[atom-presenter=windowDiv]").get(0),a=l.find("[data-atom-presenter=windowTitleDiv],[atom-presenter=windowTitleDiv]").get(0),f=this.getTemplate("windowTemplate");if(t(f).addClass("atom-window-template"),u.attr(f,"atom-dock")||u.attr(f,"atom-dock","Fill"),f.length)for(s=0;s<f.length;s++)c.appendChild(f[s]);else c.appendChild(f);e=this.getTemplate("commandTemplate");e&&(u.attr(e,"atom-dock","Bottom"),e.setAttribute("class","atom-wizard-command-bar"),c.appendChild(e));this.set_innerTemplate(o);this._iframe&&(this._iframe.atomWindow=this);i&&(this._opener=i,AtomBinder.refreshValue(this,"opener"),AtomBinder.refreshValue(this,"openerData"));h=this;r.dispatcher.callLater(function(){var n,i;if(AtomBinder.setValue(h,"isOpen",!0),!h._url&&(n=t(h._windowPlaceholder).find("input"),n.length>0)){i=n.get(0);try{i.focus()}catch(r){}}})},init:function(){t(this._element).addClass("atom-window-placeholder");n.init.call(this);var i=this;this.closeCommand=function(){i.onCloseCommand.apply(i,arguments)};this.cancelCommand=function(){i.onCancelCommand.apply(i,arguments)};this.openCommand=function(){i.openWindow.apply(i,arguments)};r.dispatcher.callLater(function(){var n=i._element;n._logicalParent||(n._logicalParent=n.parentNode,t(n).remove(),o.body.appendChild(n))})}}})}(r.AtomControl.prototype);r.AtomWindow.openNewWindow=function(n){var h=o.createElement("DIV"),v=u.assignID(h),e,f,c,l,s,a;n.localScope&&h.setAttribute("data-atom-local-scope","true");h._logicalParent=n.opener;o.body.appendChild(h);e=u.createControl(h,r.AtomWindow);f=n.url;f.length!==undefined?(n.next=f[1],n.url=f[0],f=new AtomUri(n.url)):(f={path:f.path,query:f.prop,hash:f.scope},n.url.next&&(n.next=n.url.next));e._next=[n.next||{},function(){r.dispatcher.callLater(function(){e.dispose();t(h).remove()})}];c=f.path;u.isNode(c)||(c=i.get(n.scope,f.path));l=t(u.cloneNode(c));s=l.children("[atom-template=commandTemplate],[data-atom-template=commandTemplate]").get(0);s&&(u.removeAttr(s,"atom-template"),e._commandTemplate=s,t(s).remove());s=l.children("[atom-template=windowTemplate],[data-atom-template=windowTemplate]").get(0);s?(u.removeAttr(s,"atom-template"),e._windowTemplate=s):(u.removeAttr(c,"atom-template"),e._windowTemplate=c);n.localScope&&n.opener&&(a=n.opener.get_data(),e._data=a);e.init();r.dispatcher.callLater(function(){var o=e.get_scope(),u=f.hash,r;for(var t in u)u.hasOwnProperty(t)&&i.set(o,t,u[t]);r=f.query;for(t in r)r.hasOwnProperty(t)&&i.set(e,t,r[t]);e.openWindow(n.scope,n.opener)})},function(n){return classCreatorEx({name:"WebAtoms.AtomCalendar",base:n,start:function(n){t(n).addClass("atom-calendar");var i=new Date;this._month=i.getMonth()+1;this._year=i.getFullYear();this._startYear=-5;this._endYear=10;this._currentYear=(new Date).getFullYear();this._value=null},properties:{month:0,year:0,startYear:-5,endYear:0,currentYear:0,visibleDate:undefined},methods:{set_month:function(n){this._month=n;this.updateCalendar()},set_year:function(n){this._year=n;this.updateCalendar()},set_visibleDate:function(n){n&&n!=this._visibleDate&&(this._visibleDate=n,this._year=n.getFullYear(),this._month=n.getMonth()+1,this.updateCalendar(),AtomBinder.refreshValue(this,"year"),AtomBinder.refreshValue(this,"month"))},onCreated:function(){n.onCreated.call(this);var t=this;r.dispatcher.callLater(function(){t.updateCalendar()})},applyItemStyle:function(){},updateCalendar:function(){var i;if(this._created){var f=new Date,a=new Date(this._year,this._month-1,1),t=new Date(this._year,this._month-1,1);t.getDay()&&(i=t.getDay()-1,i=-i,t.setDate(i));for(var o=t.getMonth(),h=t.getFullYear(),e=[],r=0,c=this._month-1,r=0;r<42;r++){var l=r+t.getDate(),n=new Date(h,o,l),u=n.getDay();u=u==0||u==6;e.push({label:n.getDate(),isWeekEnd:u,isToday:f.getDate()==n.getDate()&&f.getMonth()==n.getMonth()&&f.getFullYear()==n.getFullYear(),isOtherMonth:n.getMonth()!=c,dateLabel:s.toShortDateString(n),value:s.toMMDDYY(n),date:n})}AtomBinder.setValue(this,"items",e)}},changeMonth:function(n){var t=this._month;t+=n;t>12&&(t=1,i.set(this,"year",this._year+1));t==0&&(i.set(this,"year",this._year-1),t=12);AtomBinder.setValue(this,"month",t)},init:function(){n.init.call(this);var t=this;this.nextMonthCommand=function(){t.changeMonth(1)};this.prevMonthCommand=function(){t.changeMonth(-1)}}}})}(r.AtomListBox.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomCheckBoxList",base:n,start:function(){this._allowMultipleSelection=!0;this._valueSeparator=", ";this._dataElements=[]},methods:{init:function(){n.init.call(this);t(this._element).addClass("atom-check-box-list")}}})}(r.AtomItemsControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDataPager",base:n,properties:{itemsPath:"items",totalPath:"total",pageSize:25,currentPage:0,items:null,total:0,pages:[]},start:function(){this._presenters=["pageList"];var n=this,t=AtomBinder;this.goFirstCommand=function(){t.setValue(n,"currentPage",0)};this.goLastCommand=function(){t.setValue(n,"currentPage",n._pages.length-1)};this.goNextCommand=function(){t.setValue(n,"currentPage",n.get_currentPage()+1)};this.goPrevCommand=function(){t.setValue(n,"currentPage",n.get_currentPage()-1)}},methods:{preparePages:function(){var u,t,n;if(this._items&&this._total&&this._pageSize){var f=this._items.length,r=this._total,i=Math.ceil(r/this._pageSize);if(i!=this._pages.length){for(u=this._pageSize,t=[],n=0;n<i;n++)t.push({value:n,label:n+1});AtomBinder.setValue(this,"pages",t)}}},set_items:function(n){if((n!=this._items&&this._items&&this.unbindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),n)&&(this._items=n,n!=null&&this._created)){this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal");this.onCollectionChangedInternal("refresh",-1,null)}},onCollectionChangedInternal:function(){var n=this._items,t;n.length===undefined?(t=n[this._itemsPath],AtomBinder.setValue(this,"total",n[this._totalPath]),AtomBinder.setValue(this,"value",t)):(n.total&&AtomBinder.setValue(this,"total",n.total),AtomBinder.setValue(this,"value",n));this.preparePages()},onCreated:function(){if(this._items){this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal");this.onCollectionChangedInternal("refresh",-1,null)}},set_currentPage:function(n){this._currentPage=n;AtomBinder.refreshValue(this,"pageStart")},get_pageStart:function(){return this._currentPage*this._pageSize},set_pageSize:function(n){this._pageSize=n;this.preparePages()},set_total:function(n){this._total!=n&&(this._total=n)},init:function(){t(this._element).addClass("atom-data-pager");n.init.apply(this,arguments)}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDateControl",base:n,start:function(){},properties:{startYear:-1,endYear:10},methods:{resetYears:function(){var i=this._year,t=new Date,f=t.getFullYear(),e,r,u,n;for(f+=this._startYear,e=t.getFullYear()+this._endYear,r=this._value,r||(r=t),i.options.length=0,u=1,i.options[0]=new Option("Select","",!1,!1),t=(this._value||new Date).getFullYear(),n=f;n<=e;n++)i.options[u]=new Option(n,n,!1,t==n),u++},set_value:function(n){n&&n.constructor==String&&(n=new Date(parseInt(n.substr(6))));this._value=n;this.setDate()},setDate:function(){if(this._value){var n=this._value,t=n.getMonth()+1,i=n.getDate(),r=n.getFullYear();this.setComboValue(this._month,t);this.setComboValue(this._year,r);this.setComboValue(this._date,i)}},setComboValue:function(n,t){for(var i=new f(n.options);i.next();)if(i.current().value==t){n.selectedIndex=i.currentIndex();break}},set_startYear:function(n){this._startYear=n;this.resetYears()},set_endYear:function(n){this._endYear=n;this.resetYears()},onDataChange:function(){var n=t(this._year).val(),r=t(this._month).val(),u=t(this._date).val(),f;try{n&&r&&u?(f=new Date(n,r-1,u,9,0,0),this._value=f):this._value=null}catch(e){i.alert(e)}AtomBinder.refreshValue(this,"value")},setMonths:function(){var r=s.monthList,t=this._month.options,n,i;for(t.length=0,n=new f(r),t[0]=new Option("Select","",!1,!1);n.next();)i=n.current(),t[n.currentIndex()+1]=new Option(i.label,i.value,!1,!1);this.setDate();AtomBinder.refreshValue(this,"value")},init:function(){var i=this._element,r,t;for(this._date=o.createElement("SELECT"),this._month=o.createElement("SELECT"),this._year=o.createElement("SELECT"),i.style.height="25px",i.appendChild(this._date),i.appendChild(this._month),i.appendChild(this._year),r=this._date.options,r[0]=new Option("Select","",!1,!1),t=1;t<32;t++)r[t]=new Option(t,t,!1,!1);this.resetYears();this.bindEvent(this._date,"change","onDataChange");this.bindEvent(this._month,"change","onDataChange");this.bindEvent(this._year,"change","onDataChange");this.setMonths();n.init.apply(this,arguments)}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDateField",base:n,start:function(n){this._presenters=["calendarPresenter","itemsPresenter"];t(n).addClass("atom-date-field")},properties:{isOpen:!1,time:"9:00 AM"},methods:{get_offsetLeft:function(){return t(this._element).offset().left},get_offsetTop:function(){return t(this._element).offset().top},onPopupRemoved:function(){AtomBinder.setValue(this,"isOpen",!1)},set_isOpen:function(n){if(this._isOpen=n,n){this.getTemplate("popupTemplate");this.popup=u.cloneNode(this._popupTemplate);this.popup._logicalParent=this._element;this.popup._templateParent=this;o.body.appendChild(this.popup);this.onCreateChildren(this.popup);this.setProperties(this.popup);this.initChildren(this.popup);var r=this;this._refreshInterval=setInterval(function(){AtomBinder.refreshValue(r,"offsetLeft");AtomBinder.refreshValue(r,"offsetTop")});k.show(this._element,this.popup,-1,function(){i.set(r,"isOpen",!1)})}else this._refreshInterval&&clearInterval(this._refreshInterval),this.popup&&(this.disposeChildren(this.popup),t(this.popup).remove(),this.popup=null)},dispose:function(){this.set_isOpen(!1);n.dispose.call(this)},get_isOpen:function(){return this._isOpen},get_selectedItem:function(){return this._selectedItems.length?this._selectedItems[0]:null},set_time:function(n){if(!this._set_timeCalled){if(this._set_timeCalled=!0,n){this._time=n;var t=s.setTime(this.get_value(),n);AtomBinder.setValue(this,"value",t)}this._set_timeCalled=!1}},set_value:function(n){n=s.parse(n);this._value=n;AtomBinder.setValue(this,"time",s.toTimeString(n));this._selectedItems.length=0;n&&(this._selectedItems.push({date:n,dateLabel:s.toShortDateString(n),value:s.toMMDDYY(n),label:n.getDate()}),this.set_visibleDate(n));this._created&&(AtomBinder.refreshItems(this._selectedItems),AtomBinder.refreshValue(this,"value"),AtomBinder.refreshValue(this,"selectedItem"),AtomBinder.refreshValue(this,"selectedItems"))},get_value:function(){return this._selectedItems.length?this._selectedItems[0].date:this._value},toggleDate:function(n,t){var i=t.get_data();this._selectedItems.length=0;AtomBinder.addItem(this._selectedItems,i);AtomBinder.refreshValue(this,"value");AtomBinder.refreshValue(this,"selectedItem");AtomBinder.refreshValue(this,"selectedItems");AtomBinder.setValue(this,"isOpen",!1)}}})}(r.AtomDateListBox.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomDeleteButton",base:n,start:function(){this._confirm=!0;this._confirmMessage="Are you sure you want to delete this item?"},methods:{},properties:{}})}(r.AtomPostButton.prototype),function(n){return createClass({name:"WebAtoms.AtomFrameView",base:n,start:function(n){var i=this;t(n).addClass("atom-frame-view");this._items=[];this._layout=r.AtomViewBoxLayout.defaultInstance;this.backCommand=function(){i.onBackCommand.apply(i,arguments)}},properties:{url:"",replaceUrl:"",layout:null,items:[],removeOnBack:!0},methods:{set_replaceUrl:function(n){var i=new f(this._items),t;for(this.set_url(n);i.next();)t=i.current(),t.url!=n&&this.replaceItemWithUrl(t)},set_url:function(n){var o,f,a,t,l;if(n){if(/replace\:/.test(n)){this.set_replaceUrl(n.substr(8));this._url=n;return}var s=n.indexOf("?"),e=n,h="",c=this;if(s!==-1&&(e=n.substr(0,s),h=n.substr(s+1)),o=this._items,f=i.query(o).firstOrDefault({url:e}),f)i.set(this,"selectedIndex",f.index),this.updateUI();else{if(a=i.get(this,"scope"),t=a[e],!t){console&&console.error&&console.error("Page Template "+t+" not found");return}t=u.cloneNode(t);t._logicalParent=this._element;f={url:e,index:o.length,opener:this._url,element:t};i.add(o,f);l=u.createControl(t,u.getAtomType(t)||r.AtomControl);f.control=l;r.dispatcher.callLater(function(){l.init();c._element.appendChild(t);i.set(c,"selectedIndex",f.index);c.updateUI()})}h&&this.invokeAction({appScope:u.parseUrl(h)});this._url=n}},replaceItemWithUrl:function(n,t){if(t&&this.set_url(t),n){var i=this;setTimeout(function(){i.removeItem(n)},1e3)}},removeItem:function(n){i.remove(this._items,n);n.control.dispose();t(n.element).remove();for(var r=new f(this._items);r.next();)n=r.current(),n.index=r.currentIndex()},onBackCommand:function(){var n=this._selectedIndex,t,r;n&&(t=i.query(this._items).firstOrDefault({index:n}),t&&(r=this,n=n-1,i.set(this,"selectedIndex",n),r._removeOnBack&&this.replaceItemWithUrl(t,t.opener)))},init:function(){n.init.call(this);var i=this,t=this._url;t&&r.dispatcher.callLater(function(){i.set_url(t)})}}})}(r.AtomViewStack.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomLinkBar",base:n,start:function(){this._allowSelectFirst=!1;var n=this;this.openMenuCommand=function(){n.openMenu.apply(n,arguments)}},properties:{itemsPath:"items",selectCurrent:!0,targetPath:"",menuTemplate:null,menuDirection:"horizontal"},methods:{setClass:function(){var n=t(this._element);n.removeClass("atom-tab-bar atom-link-bar");n.addClass(this._showTabs?"atom-tab-bar":"atom-link-bar")},set_menuDirection:function(n){var i=t(this._element);i.removeClass("vertical horizontal");i.addClass(n);this._menuDirection=n},onClick:function(){},openMenu:function(n){var s=n.target,e=this.get_atomParent(s),f,t,i;e!=null&&(f=e.get_data(),f[this._itemsPath])&&(t=this._subMenu,t?k.hide(t._element):(i=this.getTemplate("menuTemplate"),t=u.cloneNode(i),t._templateParent=this,t.style.position="absolute",o.body.appendChild(t),i=u.getAtomType(i)||r.AtomControl,t=u.createControl(t,i,f),this._subMenu=t),AtomBinder.setValue(t,"data",f),k.show(e._element,t._element,0),u.cancelEvent(n))},selectDefault:function(){this._items&&this._selectCurrent&&(this._value||(AtomBinder.setValue(this,"value",location.pathname),this.get_selectedIndex()==-1&&this.selectItem(this._items),this.updateSelectionBindings()))},selectItem:function(n,t){for(var u=new f(n),e=this._valuePath,o=location.pathname.toLowerCase(),i,r;u.next();)if(i=u.current(),r=i,e&&(r=r[e]),r){if(o==r.toLowerCase())return t||AtomBinder.setValue(this,"selectedItem",i),!0;if(i.links&&this.selectItem(i.links,!0))return AtomBinder.setValue(this,"selectedItem",i),!0}return!1},dispose:function(){this._subMenu&&(this._subMenu.dispose(),this._subMenu=null);n.dispose.apply(this,arguments)},init:function(){n.init.apply(this,arguments);this.bindEvent(this._element,"click","openMenuCommand");this.set_menuDirection("horizontal")}}})}(r.AtomToggleButtonBar.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomMultiButtonList",base:n,start:function(){this._dataElements=[]},properties:{labelPath:"label",valuePath:"value",options:null,isRadio:!1,items:null},methods:{set_options:function(n){if(this._options=n,n)this.onCollectionChangedInternal("refresh",-1,null)},set_value:function(n){this._value=n;this.updateSelections()},set_items:function(n){if(this._items&&this.unbindEvent(this._items,"CollectionChanged","onCollectionChangedInternal"),this._items=n,n!=null){this.bindEvent(this._items,"CollectionChanged","onCollectionChangedInternal");this.onCollectionChangedInternal("refresh",-1,null)}},onCollectionChangedInternal:function(n,t,i){var r=this.get_value();this.onCollectionChanged(n,t,i);this.set_value(r)},onCollectionChanged:function(){var n,t,i;if(this._items&&this._options){for(this._dataElements=[],this.unbindEvent(null,"change","onDataChange"),n=new f(this._items),t=this.get_scope();n.next();)i=n.current(),this.createChildElement(t,this._element,i);this.updateUI()}},updateSelections:function(){var e,r,n,i,o,u;if(this._dataElements&&this._dataElements.length!=0){for(n=new f(this._dataElements);n.next();)e=n.current(),e.checked=!1;if(this._value)for(o=this._value.split(","),n.reset();n.next();)for(u=n.current(),r=new f(o);r.next();)i=r.current(),i=t.trim(i),u.value==i&&(u.checked=!0)}},onDataChange:function(){for(var i=new f(this._dataElements),r=[],n,u;i.next();)n=i.current(),u=t(n).val(),n.checked&&r.push(u);this._value=r.join(", ");AtomBinder.refreshValue(this,"value")},createChildElement:function(n,i,r){var e=o.createElement("SPAN"),a,h,y,p,c,w,s,b;for(i.appendChild(e),i=e,e=o.createElement("SPAN"),a=this.get_labelPath(),h=this.get_valuePath(),l=r,v=r,a&&(l=r[a]),h&&(v=r[h]),y=null,this._isRadio&&(y="_g"+u.getNewIndex()),i.appendChild(e),p=new f(this._options);p.next();)c=p.current(),h&&(c=c[h]),w=v+"."+c,s=o.createElement("INPUT"),this._isRadio?(u.attr(s,"type","radio"),u.attr(s,"name",y)):u.attr(s,"type","checkbox"),t(s).val(w),e.appendChild(s),this.bindEvent(s,"change","onDataChange"),this._dataElements.push(s);e=o.createElement("SPAN");i.appendChild(e);b=o.createTextNode(l);e.appendChild(b)}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomNavigatorList",base:n,start:function(){this._displayMode=0;this._presenters=["gridPanel","gridPresenter","itemsPresenter","detailHeaderPresenter","newHeaderPresenter","detailPresenter","newPresenter","newView","detailView","newHeaderToolbar","detailHeaderToolbar"];this._layout=new r.AtomViewBoxLayout;this._newItem={}},properties:{autoShowDetail:!0,currentPage:null,pageSize:undefined,newItem:null,newUrl:null,detailUrl:null,displayMode:null},methods:{get_newItemCopy:function(){return this._newItemCopy},onBackCommand:function(){AtomBinder.setValue(this,"displayMode",0);this.updateDisplayMode();AtomBinder.setValue(this,"selectedIndex",-1)},onCancelAddNewCommand:function(){this.onBackCommand();AtomBinder.refreshValue(this,"newItemCopy");this.refresh()},onAddCommand:function(){AtomBinder.setValue(this,"selectedIndex",-1);AtomBinder.setValue(this,"displayMode",2);var n=this._newItem||{};this._newItemCopy=AtomBinder.getClone(n);AtomBinder.refreshValue(this,"newItemCopy");this.updateDisplayMode()},onSelectedItemsChanged:function(){n.onSelectedItemsChanged.apply(this,arguments);this._autoShowDetail&&this.showDetailCommand()},addTemplate:function(n,t,i){if(i){n.appendChild(t);t._templateParent=this;this.onCreateChildren(n);this.initChildren(n)}else{n.appendChild(t);t._templateParent=this;this.onCreateChildren(n)}},updateDisplayMode:function(){var e=this._displayMode;if(e==0){this._detailPresenter&&(this._detailView.atomControl.dispose(this._detailPresenter),this._detailPresenter=null);this._newPresenter&&(this._newView.atomControl.dispose(this._newPresenter),this._newPresenter=null);this._detailHeaderPresenter&&(this._detailView.atomControl.dispose(this._detailHeaderPresenter),this._detailHeaderPresenter=null);this._newHeaderPresenter&&(this._newView.atomControl.dispose(this._newHeaderPresenter),this._newHeaderPresenter=null);return}var i=null,t=this.getTemplate("detailTemplate"),r=null,n,f="";e==1?(i=this._detailView,r=this._detailHeaderToolbar,n=this.getTemplate("detailHeaderTemplate"),f="_detail"):(i=this._newView,r=this._newHeaderToolbar,n=this.getTemplate("newHeaderTemplate"),f="_new");r&&n&&(n=u.cloneNode(n),this.addTemplate(r,n,!0),this[f+"HeaderPresenter"]=n);i&&t&&(t=u.cloneNode(t),this.addTemplate(i,t,!0),this[f+"Presenter"]=t)},createChildren:function(){var f,o,e,i,r;n.createChildren.call(this);this.getTemplate("gridTemplate");this.getTemplate("detailTemplate");this.getTemplate("searchTemplate");this.getTemplate("detailHeaderTemplate");this.getTemplate("newHeaderTemplate");this.getTemplate("headerTemplate");this.getTemplate("footerTemplate");f=this.get_scope();this._newView.atomControl._scope=new g(this,f);this._detailView.atomControl._scope=new g(this,f);o=u.cloneNode(this._gridTemplate);this.addTemplate(this._gridPresenter,o);e=this._detailTemplate;u.attr(e,"atom-dock")||u.attr(e,"atom-dock","Fill");this._headerTemplate&&(i=u.cloneNode(this._headerTemplate),i.setAttribute("atom-dock","Top"),t(i).addClass("atom-navigator-list-header"),i._templateParent=this,this.addTemplate(this._gridPanel,i));this._footerTemplate&&(r=u.cloneNode(this._footerTemplate),r.setAttribute("atom-dock","Bottom"),t(r).addClass("atom-navigator-list-footer"),this.addTemplate(this._gridPanel,r))},init:function(){n.init.call(this);var t=this;this.backCommand=function(){t.onBackCommand.apply(t,arguments)};this.addCommand=function(){t.onAddCommand.apply(t,arguments)};this.cancelAddCommand=function(){t.onCancelAddNewCommand.apply(t,arguments)};this.showDetailCommand=function(){var n=t.get_selectedItem();n&&(AtomBinder.setValue(t,"displayMode",1),t.updateDisplayMode())}}}})}(r.AtomListBox.prototype),function(t){var i=n.AtomUI;return classCreatorEx({name:"WebAtoms.AtomNumberComboBox",base:t,start:function(){},properties:{showPrompt:!1,startNumber:undefined,endNumber:undefined,step:1},methods:{set_startNumber:function(n){this._startNumber=n;this.resetNumbers()},set_endNumber:function(n){this._endNumber=n;this.resetNumbers()},set_step:function(n){n&&(this._step=n,this.resetNumbers())},onLoaded:function(){this.resetNumbers()},resetNumbers:function(){if(this._created&&this._startNumber!==undefined&&this._endNumber!==undefined){var n=i.toNumber(this._startNumber),r=i.toNumber(this._endNumber),u=i.toNumber(this._step),t=[];for(this._showPrompt&&t.push({label:"Select",value:0});n<=r;n+=u)t.push({label:n,value:n});this.set_items(t)}}}})}(r.AtomComboBox.prototype),function(t){var u=n.document,i=n.$;return classCreatorEx({name:"WebAtoms.AtomPhoneControl",base:t,start:function(){this._value=""},properties:{countries:[{label:"(US +1)",code:1,country:"US",format:"999-999-9999"},{label:"(CA +1)",code:1,country:"CA",format:"999-999-9999"},{label:"(IN +91)",code:91,country:"IN",format:"99-99-999999"},{label:"(UK +44)",code:44,country:"UK",format:"999-999-9999"},]},methods:{set_value:function(n){this._value=n;this._countries&&this.setupValues()},set_required:function(n){if(!this.num){var t=this;r.dispatcher.callLater(function(){t.set_required(n)});return}this._required=n;n?p.required.call(this,this.num,!0):p.required.call(this,this.num,!1)},get_required:function(){return this._required},setupValues:function(){var u,t;if(!this._value){i(this.num).val("");i(this.ext).val("");i(this.msg).val("");return}for(var n=this._value.split(":",6),e=n[1],r=new f(this._countries);r.next();)if(u=r.current(),u.country==e){this.cs.selectedIndex=r.currentIndex();break}t=(n[3]||"").split(".").join("-");t=="--"&&(t="");i(this.num).val(t);i(this.ext).val(n[4]);i(this.msg).val(n[5]);this.onFormat()},onDataChange:function(){var n="v2:",u=this.cs.selectedIndex,r=this._countries[u],t;n+=r.country+":"+r.code;t=i(this.num).val().split("-").join(".");n+=":"+t;n+=":"+i(this.ext).val();n+=":"+i(this.msg).val();this._value=t?n:"";AtomBinder.refreshValue(this,"value")},set_countries:function(n){this._countries=n;this.onFormat()},onCountryChange:function(){this.onDataChange();this.onFormat()},onFormat:function(){var e,r,t,u,n;if(!this._isFormatting){for(this._isFormatting=!0,e=this._countries,r=this.cs.options,r.length=0,t=new f(e);t.next();)n=t.current(),n.valueIndex||(n.label=n.label,n.valueIndex=t.currentIndex()),r[t.currentIndex()]=new Option(n.label,n.valueIndex,!1,!1);(this.setupValues(),u=this.cs,u.selectedIndex!=-1)&&(n=this._countries[u.selectedIndex],n.format?i(this.num).mask(n.format):i(this.num).unmask(),this._isFormatting=!1)}},init:function(){var n,f,e;this.cs=u.createElement("SELECT");this.num=u.createElement("INPUT");this.num.type="text";this.ext=u.createElement("INPUT");this.ext.type="text";i(this.ext).attr("placeholder","Ext.");this.msg=u.createElement("INPUT");this.msg.type="text";i(this.msg).attr("placeholder","Message");n=this.get_element();n.appendChild(this.cs);n.appendChild(this.num);n.appendChild(this.ext);n.appendChild(this.msg);f=this;this.onKeyUpLater=function(n){var t=n;f.onDataChange(t)};this.bindEvent(this.cs,"change","onCountryChange");this.bindEvent(this.num,"change","onDataChange");this.bindEvent(this.num,"keyup","onKeyUpLater");this.bindEvent(this.num,"keypress","onKeyUpLater");this.bindEvent(this.ext,"change","onDataChange");this.bindEvent(this.msg,"change","onDataChange");i(this._element).addClass("atom-phone-control");i(this.num).addClass("atom-pc-num");i(this.msg).addClass("atom-pc-msg");i(this.cs).addClass("atom-pc-cs");i(this.ext).addClass("atom-pc-ext");t.init.call(this);e=this;r.dispatcher.callLater(function(){e.onFormat()})}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomRadioButtonList",base:n,start:function(){this._allowMultipleSelection=!1},properties:{groupName:""},methods:{init:function(){this._groupName="__g"+u.getNewIndex();n.init.call(this)}}})}(r.AtomItemsControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomSortableColumn",base:n,start:function(){},properties:{direction:"",defaultDirection:"",label:"",sortField:null},methods:{set_direction:function(n){this._direction=n;var i=t(this._element);i.removeClass("atom-sort-asc atom-sort-desc");n&&i.addClass("atom-sort-"+n.toLowerCase())},set_value:function(n){this._value=n;this.refreshUI()},refreshUI:function(){if(this._value){if(this._value.indexOf(this._sortField)==-1){AtomBinder.setValue(this,"direction","");return}this._value.lastIndexOf("desc")!=this._value.length-4?AtomBinder.setValue(this,"direction","asc"):AtomBinder.setValue(this,"direction","desc")}},onClick:function(){this._direction?this._direction=="asc"?AtomBinder.setValue(this,"direction","desc"):AtomBinder.setValue(this,"direction","asc"):AtomBinder.setValue(this,"direction",this._defaultDirection);AtomBinder.setValue(this,"value",this._sortField+" "+this._direction)},init:function(){n.init.call(this);this.bindEvent(this._element,"click","onClick");t(this._element).addClass("atom-column")},onUpdateUI:function(){this.refreshUI()}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomTabButtonBar",base:n,start:function(){this._allowMultipleSelection=!1;this._showTabs=!0},methods:{}})}(r.AtomLinkBar.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomTabControl",base:n,start:function(){this._presenters=["itemsPresenter"];this._layout=r.AtomViewBoxLayout.defaultInstance;this.selectedIndex=0;this.labelPath="label"},properties:{items:null},methods:{createChildren:function(){var i,t,r,e;if(n.createChildren.call(this),this._itemsPresenter!=this._element){for(i=[],t=new h(this._element);t.next();)r=t.current(),this._element.removeChild(r),i.push(r);if(this._template){e=u.cloneNode(this._template);e._templateParent=this;this._element.appendChild(e);this.onCreateChildren(this._element)}for(t=new f(i);t.next();)this._itemsPresenter.appendChild(t.current());if(this._template)this.onCreateChildren(this._itemsPresenter)}}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomTimePicker",base:n,start:function(){tt("AtomTimePicker is Depricated !!!, use AtomTimeEditor")},properties:{displayLabel:"9:00 AM"},methods:{init:function(){var r,t,u,f,i;for(this._autoOpen=!0,r=[],t=0;t<=23;t++)u="AM",f=t,t>11&&(u="PM",t>12&&(f=t-12)),i=f+":00 "+u,r.push({label:i,value:i}),i=f+":30 "+u,r.push({label:i,value:i});this._items=r;n.init.call(this)}}})}(r.AtomAutoCompleteBox.prototype);lt=function(n){this._self=n;this._updating=!1;this.update=function(n){if(!this._updating)try{this._updating=!0;n.apply(this._self)}finally{this._updating=!1}}},function(n){var r=/^([0-1]?[0-9]|2[0-3]):[0-5][0-9] [ap][m]$/i;return classCreatorEx({name:"WebAtoms.AtomTimeEditor",base:n,start:function(n){t(n).addClass("atom-time-editor");this._updater=new lt(this)},properties:{time:"10:00",ap:"AM",value:"10:00 AM"},methods:{get_hours24:function(){var t=this._time.split(":"),n=parseInt(t[0]||"0");return this._ap=="PM"&&n!=12&&(n+=12),n},set_hours24:function(n){this.setTime(n,this.get_minutes())},get_hours:function(){var n=this._time.split(":");return parseInt(n[0]||"0")},get_minutes:function(){var n=this._time.split(":");return parseInt(n[1]||"0")},setTime:function(n,t,i){var r=this.get_ap();i&&n>12&&(n-=12,r="PM");n=""+n;n.length==1&&(n="0"+n);t=t+"";t.length==1&&(t="0"+t);AtomBinder.setValue(this,"value",n+":"+t+" "+r)},set_hours:function(n){this.setTime(n,this.get_minutes())},set_minutes:function(n){this.setTime(this.get_hours(),n)},set_value:function(n){this._updater.update(function(){if(this._value!=n){if(!r.test(n))throw new Error("Unknown time format, expecting ##:## AM");this._value=n;n=n.split(" ");this._time=n[0];this._ap=n[1].toUpperCase();this.refreshProperties()}})},refreshProperties:function(){i.refresh(this,"value");i.refresh(this,"time");i.refresh(this,"ap");i.refresh(this,"hours");i.refresh(this,"hours24");i.refresh(this,"minutes")},set_time:function(n){this.set_value(n+" "+this._ap)},set_ap:function(n){this.set_value(this._time+" "+n)},get_value:function(){return this._time+" "+this._ap}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomUploadButton",base:n,start:function(n){if(/input/gi.test(n.nodeName)&&/file/gi.test(u.attr(n,"type"))){this._filePresenter=n;return}var i=this._filePresenter=o.createElement("input");u.attr(i,"type","file");t(i).css({left:"-500px",position:"absolute",top:"0"});o.body.appendChild(this._filePresenter)},properties:{fileTypes:undefined,accept:"*/*",capture:"",progress:0},methods:{set_accept:function(n){if(this._accept=n,n){var t=this._filePresenter;t&&u.attr(t,"accept",n)}},set_capture:function(n){if(this._capture=n,n){var t=this._filePresenter;t&&u.attr(t,"capture",n)}},onClickHandler:function(n){(!this._confirm||confirm(this._confirmMessage))&&this._postUrl&&this._filePresenter!=this._element&&(t(this._filePresenter).trigger("click"),u.cancelEvent(n))},onFileSelected:function(){var t=this.get_postData(),i,o,n,r,u,e;if(t!==null&&t!==undefined){if(i=this._mergeData,i)for(o in i)t[o]=i[o];if(n=this._xhr,!n){n=new XMLHttpRequest;r=n.upload;try{n.timeout=36e5}catch(s){}this.bindEvent(r,"progress","onProgress");this.bindEvent(r,"timeout","onError");this.bindEvent(r,"error","onError");this.bindEvent(n,"load","onComplete");this.bindEvent(n,"error","onError");this.bindEvent(n,"timeout","onError");this._xhr=n}for(u=new FormData,e=new f(this._filePresenter.files);e.next();)u.append("file"+e.currentIndex(),e.current());u.append("formModel",JSON.stringify(AtomBinder.getClone(t)));n.open("POST",this._postUrl);n.send(u);atomApplication.setBusy(!0,"Uploading...")}},set_progress:function(n){this._progress=n;n&&AtomBinder.setValue(atomApplication,"progress",n)},onError:function(n){atomApplication.setBusy(!1,"Uploading...");this.unbindEvent(this._xhr);this._xhr=null;this._lastError=n;i.alert("Upload failed")},onProgress:function(n){if(n.lengthComputable){var t=Math.round(n.loaded*100/n.total);AtomBinder.setValue(this,"progress",t)}},onComplete:function(n){atomApplication.setBusy(!1,"Uploading...");if(n.target)if(n.target.status==200)this._value=n.target.responseText;else{i.alert(n.target.statusText);return}else this._value=n.result;this.unbindEvent(this._xhr);this._xhr=null;AtomBinder.refreshValue(this,"value");this.invokeAction(this._next,n)},init:function(){n.init.call(this);var t=this._filePresenter;this.bindEvent(t,"change","onFileSelected")}}})}(r.AtomPostButton.prototype),function(n,t){return classCreatorEx({name:"WebAtoms.AtomViewBox",base:t,start:function(){this._layout=n.AtomViewBoxLayout.defaultInstance},methods:{}})}(r,r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomWizard",base:n,start:function(){this._presenters=["viewPresenter"]},properties:{currentStep:null,nextLabel:"Next",nextClass:"",buttons:null,prevLabel:"Back",finishLabel:"Finish",canMoveBack:!0,canMoveNext:!0,steps:0,isLastStep:!1},methods:{set_currentStep:function(n){var t,i;this._currentStep=n;t=this._buttons;t&&t.length&&(i=t[n],AtomBinder.setValue(this,"nextLabel",i.label),AtomBinder.setValue(this,"nextClass",i.styleClass));AtomBinder.refreshValue(this,"isLastStep")},get_isLastStep:function(){return this._currentStep==this._steps-1},createWizard:function(){var f=this._viewPresenter,n,t,o,s;this.disposeChildren(f);for(var c=this._viewTemplate,i=0,e=new h(c);e.next();)i++,n=u.cloneNode(e.current()),f.appendChild(n),t=u.getAtomType(n),t||(t="AtomViewBox",u.attr(n,"data-atom-type",t)),o=u.getAtomType(n)||r.AtomControl,s=u.createControl(n,o),s.init();AtomBinder.setValue(this,"steps",i);i&&AtomBinder.setValue(this,"currentStep",0)},init:function(){t(this._element).addClass("atom-wizard");n.init.call(this);var i=this,r=this._viewPresenter;this.goNextCommand=function(n,t,r){i.get_isLastStep()?(i.invokeAction(i._next,r),AtomBinder.setValue(i,"canMoveBack",!1)):AtomBinder.setValue(i,"currentStep",i._currentStep+1)};this.goPrevCommand=function(){AtomBinder.setValue(i,"currentStep",i._currentStep-1)};this.resetCommand=function(){i.createWizard();AtomBinder.setValue(i,"currentStep",0);AtomBinder.setValue(i,"canMoveBack",!0)};this.createWizard();this.nextCommand=function(n,t,u){var f=r.atomControl.get_selectedChild().atomControl;if(f._next){f.invokeAction(f._next);return}i.goNextCommand(n,t,u)}}}})}(r.AtomDockPanel.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomYesNoControl",base:n,start:function(){this._allowSelectFirst=!1;this._items=[{label:"Yes",value:!0},{label:"No",value:!1}]},methods:{}})}(r.AtomToggleButtonBar.prototype),function(i){return classCreatorEx({name:"WebAtoms.AtomYesNoCustom",base:i,start:function(){this._presenters=["yesNo","input"];this._hasValue=!1},properties:{hasValue:!1,placeholder:null},methods:{set_hasValue:function(n){this._hasValue=n;n||AtomBinder.setValue(this,"value","")},set_value:function(n){this._value=n;AtomBinder.setValue(this,"hasValue",n?!0:!1);this._onUIChanged||t(this._input).val(n)},onValueChange:function(){this._onUIChanged=!0;var n=t(this._input).val();AtomBinder.setValue(this,"value",n);this._onUIChanged=!1},onUpdateUI:function(){if(t(this._input).addClass("atom-yes-no-custom-input"),this._placeholder){u.attr(this._input,"placeholder",this._placeholder);var i=n.placeHolderFixer;i&&i.refresh()}},init:function(){i.init.call(this);this._yesNo=this._yesNo.atomControl;var n=this._input;this.bindEvent(n,"change","onValueChange")}}})}(r.AtomControl.prototype);n.appScope=n.appScope||{};this.atomApplication=null,function(f){return classCreator("WebAtoms.AtomApplication",f,function(i){var o,f,r,s,e,h;if(t(i).removeClass("atom-dock-panel"),t(i).addClass("atom-application"),this._scope=new g(this,null,this),n.model&&(n.appScope.model=n.model,this._data=n.model),n.appScope){o=this._scope;r=n.appScope;for(e in r)o[e]=r[e]}if(n.appScope=this._scope,n.atomApplication=this,this.busyCount=0,f=location.hash,f=f?f.substr(1):f,f){r=u.parseUrl(f);this._hash=location.hash;s=this._scope;this._defaultHash=r;for(e in r)h=r[e],s[e]=h}else this._hash=location.hash;this._defaultScope={}},{get_title:function(){return o.title},set_title:function(n){o.title=n},get_isBusy:function(){return this.busyCount},setBusy:function(n,t){n?this.busyCount++:this.busyCount--;t!==undefined?(t||(t=""),AtomBinder.setValue(this,"busyMessage",t)):AtomBinder.setValue(this,"busyMessage","Loading...");AtomBinder.refreshValue(this,"isBusy")},updateUI:function(){f.updateUI.call(this);AtomBinder.refreshValue(this,"appWidth");AtomBinder.refreshValue(this,"appHeight");AtomBinder.refreshValue(this,"bodyWidth");AtomBinder.refreshValue(this,"bodyHeight")},onUpdateUI:function(){this._renderAsPage||f.onUpdateUI.call(this)},get_appWidth:function(){return t(this._element).width()},get_appHeight:function(){return t(this._element).height()},get_bodyWidth:function(){return t(o.body).width()},get_bodyHeight:function(){return t(o.body).height()},onHashChanged:function(){var f,t,r,e,s,n,o;if(!this._noHashRefresh){if(f=this._scope,t=location.hash,t||(t="#"),this._noHashRefresh=!0,t=t.substr(1),r=u.parseUrl(t),this._created){e=this._defaultScope;for(n in e)s=e[n],r[n]===undefined&&(r[n]=s);for(n in r)o=r[n],f[n]!=o&&AtomBinder.setValue(f,n,o)}else i.merge(f,r);this._noHashRefresh=!1}},invokeUpdateUI:function(){var i=this,t=this;n.setTimeout(function(){return t.updateUI()},5)},onRefreshValue:function(){var u,n,t,i;if(!this._noHashRefresh&&this._ready){var f=this._defaultScope,r=AtomBinder.getClone(this._defaultHash||{}),e=this._scope;for(n in e)if(t=e[n],f.hasOwnProperty(n)){if(t==f[n])continue;r[n]=t}else{if(n.indexOf("_")==0)continue;if(t===undefined||t===null)continue;if(!/string|number|boolean/i.test(typeof t))continue;r[n]=t}u=[];for(n in r)t=r[n],u.push({key:n,value:t});(i="#"+u.map(function(n){return n.key+"="+encodeURIComponent(n.value)}).join("&"),i!=location.hash)&&(i!="#"||location.hash)&&(this._noHashRefresh=!0,history&&history.pushState?history.pushState({},o.title,location.href.split("#")[0]+i):location.href=i,this._noHashRefresh=!1)}},onInitialized:function(){var i,r;this._ready=!0;f.onInitialized.call(this);this._renderAsPage||t(this._element).addClass("atom-dock-application");y.isIE&&y.majorVersion<8?(i=this,setInterval(function(){i.onCheckHash()},1e3),this._lastHash=location.hash):(r=n.onhashchange?"onhashchange":"hashchange",this.bindEvent(n,r,"onHashChanged"));AtomBinder.refreshValue(this,"appHeight");AtomBinder.refreshValue(this,"bodyHeight")},createChildren:function(){if(f.createChildren.call(this),this.getTemplate("busyTemplate"),this._busyTemplate){this._element.appendChild(this._busyTemplate);this.onCreateChildren(this._busyTemplate)}},onCreated:function(){f.onCreated.call(this);this._next&&r.dispatcher.callLater(function(){n.atomApplication.invokeAction(n.atomApplication._next)})},onCheckHash:function(){this._lastHash!=location.hash&&(this.onHashChanged(),this._lastHash=location.hash)},onCloseCommand:function(){if(parent){var n=frameElement.atomWindow;n._value=this._value;n.onCloseCommand()}},setup:function(){this.createChildren();this.init()},init:function(){this.bindEvent(n,"resize","invokeUpdateUI");var t=this;this._onRefreshValue=vt(function(){t.onRefreshValue.apply(t,arguments)});this._scope._$_watcher=this;f.init.call(this);this.closeCommand=function(){t.onCloseCommand.apply(t,arguments)}}},{renderAsPage:!1,busyMessage:"",progress:0})}(r.AtomDockPanel.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomAutoPostForm",base:n,start:function(){},properties:{isBusy:!1,postError:null},methods:{pushPost:function(n){if(!this._isBusy){this._pushPostTimeout&&clearTimeout(this._pushPostTimeout);n||(n=1e3);var t=this;this._pushPostTimeout=setTimeout(function(){r.dispatcher.callLater(function(){t.onSubmit()})},n)}},onSubmit:function(){var i,r;if((this._pushPostTimeout=0,!this._isBusy)&&this.isValid()&&(i=this.preparePostData(),i)&&(r=JSON.stringify(AtomBinder.getClone(i)),!this._cachedData||r!=this._cachedData)){this._cachedData=r;var n=this,u=e.getUrl(this._postUrl),t=e.json(u,null,{type:"POST",data:i}).then(n._success);t.failed(function(){n._isBusy=!1;n._postError=t.error.msg;AtomBinder.refreshValue(n,"isBusy");AtomBinder.refreshValue(n,"postError")});t.showProgress(!1);t.showError(!1);t.invoke()}},onCreated:function(){n.onCreated.apply(this,arguments);var t=this.preparePostData();t&&(this._cachedData=JSON.stringify(AtomBinder.getClone(t)))},onSuccess:function(){n.onSuccess.apply(this,arguments);this._isBusy=!1;AtomBinder.refreshValue(this,"isBusy")},onKeyUp:function(n){(this.pushPost(),n.target&&n.target.nodeName&&/textarea/gi.test(n.target.nodeName))||n.keyCode==13&&this.onSubmit()},init:function(){n.init.call(this);var i=this;this.pushPostHandler=function(){i.pushPost(1e3)};this.bindEvent(this._element,"click",this.pushPostHandler);t(this._element).find("input,select,textarea").bind("change",null,this.pushPostHandler)}}})}(r.AtomForm.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormField",base:n,start:function(){this._presenters=["contentPresenter"]},properties:{label:undefined,fieldId:undefined,fieldClass:undefined,required:!1,fieldVisible:!0},methods:{set_fieldVisible:function(n){this._fieldVisible=n;t(this._element).css("display",n?"":"none")},set_fieldClass:function(n){this._fieldClass=n;this.setLocalValue("class",n,this._element)},onCreated:function(){this.setup()},setup:function(){this._created&&(this._contentPresenter&&this._contentPresenter.appendChild(this._element.contentElement),AtomBinder.refreshValue(this,"fieldClass"))}}})}(r.AtomControl.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormGridLayout",base:n,start:function(){},properties:{minLabelWidth:100,cellSpacing:5,label:""},methods:{onUpdateUI:function(){AtomBinder.refreshValue(this,"controlWidth");AtomBinder.refreshValue(this,"controlHeight");n.onUpdateUI.apply(this,arguments)},get_controlWidth:function(){return t(this._element.parentNode).innerWidth()},get_controlHeight:function(){return t(this._element.parentNode).innerHeight()},createChildren:function(){var s=this._element,w,n,rt,r,l,a,b,k,c,e,d,i,v,y,p,tt;for(t(s).addClass("atom-form-grid"),c=t(s).children(),w=new f(c),u.removeAllChildren(s),n=o.createElement("DIV"),t(n).addClass("atom-form-grid-container"),s.appendChild(n),rt=u.attr(this._element,"atom-min-label-width"),this.getTemplate("fieldTemplate");w.next();){if(r=w.current(),l=u.attr(r,"atom-type"),l=="AtomFormRow"){for(a=o.createElement("TABLE"),n.appendChild(a),t(a).addClass("atom-form-grid-row"),b=o.createElement("TBODY"),a.appendChild(b),k=o.createElement("TR"),b.appendChild(k),c=t(r).children(),e=new f(c);e.next();)d=o.createElement("TD"),k.appendChild(d),this.createField(d,e.current());continue}if(l=="AtomFormTabControl"||l=="AtomTabControl"){i=o.createElement("ul");i.setAttribute("atom-type","AtomToggleButtonBar");v=u.assignID(i);i.setAttribute("atom-name",v);i.setAttribute("atom-show-tabs","true");y=o.createElement("li");i.appendChild(y);y.setAttribute("atom-text","{$data.label}");y.setAttribute("atom-template","itemTemplate");this.createField(n,i);for(var ut=it[v],e=new h(r),g=[],nt=0;e.next();)p=e.current(),t(p).remove(),p.setAttribute("style-display","[$scope."+v+".selectedIndex == "+nt+" ? '' : 'none']"),tt=this.createField(n,p),g.push(tt),nt++;ut.set_items(g);continue}this.createField(n,r)}}}})}(r.AtomFormLayout.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormTab",base:n,start:function(){},methods:{}})}(r.AtomFormGridLayout.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormNoLayout",base:n,start:function(){},methods:{}})}(r.AtomForm.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomFormVerticalLayout",base:n,start:function(){},methods:{}})}(r.AtomFormLayout.prototype),function(n){return classCreatorEx({name:"WebAtoms.AtomTableLayout",base:n,start:function(n,t,i){this._cellWidth=t;this._cellHeight=i;this._columns=n},methods:{doLayout:function(n){var u=new f(t(n).children()),i,s=0,e=0,r=Math.ceil(u._array.length/this._columns)-1,o=r,h=this._columns*this._cellWidth,c=this._cellHeight*(r+1);for(n.style.position="relative",n.style.width=h+"px",n.style.height=c+"px",n.maxRows=r;u.next();)i=u.current(),i.style.position="absolute",i.style.left=s+"px",i.style.top=e+"px",i.style.width=this._cellWidth+"px",o<=0?(o=r,s+=this._cellWidth+10,e=0):(o--,e+=this._cellHeight)}}})}(r.AtomLayout.prototype);et=function(n){return classCreatorEx({name:"WebAtoms.AtomViewBoxLayout",base:n,start:function(){},methods:{doLayout:function(n){for(var r={width:t(n).innerWidth()+"px",height:t(n).innerHeight()+"px"},u=new h(n),i;u.next();)i=u.current(),i.style.width=r.width,i.style.height=r.height,i.atomControl&&i.atomControl.updateUI()}}})}(r.AtomLayout.prototype);et.defaultInstance=new et;i.confirm=function(n,i){var s={Message:n,ConfirmValue:!1,Confirm:i?!0:!1},e=o.createElement("DIV"),f;o.body.appendChild(e);f=u.createControl(e,r.AtomWindow,s);f.set_windowWidth(380);f.set_windowHeight(120);f.set_windowTemplate(f.getTemplate("alertTemplate"));f.set_title(i?"Message":"Confirm");f.set_next(function(){f.dispose();t(e).remove();s.ConfirmValue&&i&&i()});f.refresh()};i.alert=n.__chromeCSP?function(n){i.confirm(n,null)}:function(n){alert(n)};t(o).ready(function(){var n=r.dispatcher;n.setupControls();n.start()});t(n).unload(function(){function n(t){if(t)if(t.atomControl)t.atomControl.dispose();else for(var i=new h(t);i.next();)n(i.current())}n(o.body)})}(window);
//# sourceMappingURL=atoms.min.js.map
